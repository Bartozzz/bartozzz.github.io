"use strict";(self.webpackChunklaniewski_me=self.webpackChunklaniewski_me||[]).push([[87],{4401:function(e,s,n){n.r(s),n.d(s,{Head:function(){return f},default:function(){return g}});var a=n(7294),l=n(5893),c=n(1151);function i(e){const s=Object.assign({p:"p",code:"code",pre:"pre",span:"span",h2:"h2",a:"a",ul:"ul",li:"li",strong:"strong",blockquote:"blockquote",math:"math",semantics:"semantics",mrow:"mrow",mfrac:"mfrac",mn:"mn",mo:"mo",annotation:"annotation",ol:"ol",em:"em"},(0,c.a)(),e.components),{Alert:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Alert",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.p,{children:"Barrel files consolidate the exports of multiple modules into a single file. We use them to import a module using a single import statement without worrying about the underlying folder structure."}),"\n",(0,l.jsxs)(s.p,{children:["Have a look at the following example of a ",(0,l.jsx)(s.code,{children:"Modal"})," component:"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsxs)(s.code,{className:"code-highlight",children:[(0,l.jsx)(s.span,{className:"code-line",children:"/components\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"└── /Modal\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"    ├── Modal.js\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"    ├── ModalHeader.js\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"    ├── ModalContent.js\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"    └── ModalFooter.js\n"})]})}),"\n",(0,l.jsxs)(s.p,{children:["A barrel would be an ",(0,l.jsx)(s.code,{children:"index.js"})," file at ",(0,l.jsx)(s.code,{children:"./components/Modal"})," with the following definition:"]}),"\n",(0,l.jsx)(s.pre,{className:"language-js",children:(0,l.jsxs)(s.code,{className:"language-js code-highlight",children:[(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"export"})," ",(0,l.jsxs)(s.span,{className:"token exports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"Modal"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"./Modal"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"export"})," ",(0,l.jsxs)(s.span,{className:"token exports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"ModalHeader"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"./ModalHeader"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"export"})," ",(0,l.jsxs)(s.span,{className:"token exports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"ModalContent"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"./ModalContent"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"export"})," ",(0,l.jsxs)(s.span,{className:"token exports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"ModalFooter"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"./ModalFooter"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]})]})}),"\n",(0,l.jsx)(s.p,{children:"It allows us to write a single import statement, such as:"}),"\n",(0,l.jsx)(s.pre,{className:"language-js",children:(0,l.jsx)(s.code,{className:"language-js code-highlight",children:(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"import"})," ",(0,l.jsxs)(s.span,{className:"token imports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"Modal"}),(0,l.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"ModalHeader"}),(0,l.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"ModalContent"}),(0,l.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"ModalFooter"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"./Modal"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]})})}),"\n",(0,l.jsx)(s.p,{children:"…instead of:"}),"\n",(0,l.jsx)(s.pre,{className:"language-js",children:(0,l.jsxs)(s.code,{className:"language-js code-highlight",children:[(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"import"})," ",(0,l.jsxs)(s.span,{className:"token imports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"Modal"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"./Modal/Modal"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"import"})," ",(0,l.jsxs)(s.span,{className:"token imports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"ModalHeader"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"./Modal/ModalHeader"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"import"})," ",(0,l.jsxs)(s.span,{className:"token imports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"ModalContent"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"./Modal/ModalContent"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"import"})," ",(0,l.jsxs)(s.span,{className:"token imports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"ModalFooter"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"./Modal/ModalFooter"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]})]})}),"\n",(0,l.jsx)(s.p,{children:"At first glance, barrel files look promising! Barrel files can improve code organization and make imports cleaner, especially in larger projects with many modules. But there’s a hidden cost."}),"\n",(0,l.jsxs)(s.h2,{id:"the-bundle-size-cost",children:[(0,l.jsx)(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#the-bundle-size-cost",children:(0,l.jsx)(s.span,{className:"icon icon-link"})}),"The bundle size cost"]}),"\n",(0,l.jsxs)(s.p,{children:["If you target a no-build architecture or don’t have ",(0,l.jsx)(s.a,{href:"/blog/2018-04-29-publishing-packages-to-npm/",children:"tree-shaking"})," enabled in your bundler, all the files imported in the barrel file will get bundled into the application, even when unused! It results in tons of dead code, which can impact loading times."]}),"\n",(0,l.jsxs)(s.p,{children:["Let’s have a look at the following application, which renders a simple ",(0,l.jsx)(s.code,{children:"Button"})," component from the ",(0,l.jsx)(s.a,{href:"https://mui.com/material-ui/",rel:"nofollow noopener noreferrer",target:"_blank",children:"Material Design component library"}),":"]}),"\n",(0,l.jsx)(s.pre,{className:"language-jsx",children:(0,l.jsxs)(s.code,{className:"language-jsx code-highlight",children:[(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"import"})," ",(0,l.jsxs)(s.span,{className:"token imports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"Button"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"@mui/material"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"export"})," ",(0,l.jsx)(s.span,{className:"token keyword",children:"function"})," ",(0,l.jsx)(s.span,{className:"token function",children:(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"App"})}),(0,l.jsx)(s.span,{className:"token punctuation",children:"("}),(0,l.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:["  ",(0,l.jsx)(s.span,{className:"token keyword control-flow",children:"return"})," ",(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"<"}),(0,l.jsx)(s.span,{className:"token class-name",children:"Button"})]}),(0,l.jsx)(s.span,{className:"token punctuation",children:">"})]}),(0,l.jsx)(s.span,{className:"token plain-text",children:"Text"}),(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"</"}),(0,l.jsx)(s.span,{className:"token class-name",children:"Button"})]}),(0,l.jsx)(s.span,{className:"token punctuation",children:">"})]}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsxs)(s.code,{className:"code-highlight",children:[(0,l.jsx)(s.span,{className:"code-line",children:"> node scripts/build.js\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"Creating an optimized production build...\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"Compiled successfully.\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"File sizes after gzip:\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"  151.47 kB build/static/js/main.js\n"})]})}),"\n",(0,l.jsxs)(s.p,{children:["Now let’s import the ",(0,l.jsx)(s.code,{children:"Button"})," component directly, skipping the barrel file:"]}),"\n",(0,l.jsx)(s.pre,{className:"language-diff",children:(0,l.jsxs)(s.code,{className:"language-diff code-highlight",children:[(0,l.jsx)(s.span,{className:"code-line deleted",children:(0,l.jsxs)(s.span,{className:"token deleted-sign deleted",children:[(0,l.jsx)(s.span,{className:"token prefix deleted",children:"-"}),(0,l.jsx)(s.span,{className:"token line",children:'import { Button } from "@mui/material";\n'})]})}),(0,l.jsxs)(s.span,{className:"code-line inserted",children:[(0,l.jsx)(s.span,{className:"token deleted-sign deleted",children:(0,l.jsx)(s.span,{className:"token line"})}),(0,l.jsxs)(s.span,{className:"token inserted-sign inserted",children:[(0,l.jsx)(s.span,{className:"token prefix inserted",children:"+"}),(0,l.jsx)(s.span,{className:"token line",children:'import Button from "@mui/material/Button";\n'})]})]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token inserted-sign inserted",children:(0,l.jsx)(s.span,{className:"token line"})}),"\n"]}),(0,l.jsx)(s.span,{className:"code-line",children:"export function App() {\n"}),(0,l.jsx)(s.span,{className:"code-line",children:(0,l.jsxs)(s.span,{className:"token unchanged",children:[(0,l.jsx)(s.span,{className:"token prefix unchanged",children:" "}),(0,l.jsx)(s.span,{className:"token line",children:" return <Button>Text</Button>;\n"})]})}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token unchanged",children:(0,l.jsx)(s.span,{className:"token line"})}),"}\n"]})]})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsxs)(s.code,{className:"code-highlight",children:[(0,l.jsx)(s.span,{className:"code-line",children:"> node scripts/build.js\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"Creating an optimized production build...\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"Compiled successfully.\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"File sizes after gzip:\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"  75.69 kB (-75.77 kB)  build/static/js/main.js\n"})]})}),"\n",(0,l.jsx)(n,{type:"success",children:(0,l.jsxs)(s.p,{children:["When not using a barrel file, the build size ",(0,l.jsx)("u",{children:"decreased from ~151 kB to ~75 kB"}),"."]})}),"\n",(0,l.jsx)(n,{type:"info",children:(0,l.jsx)(s.p,{children:"Fortunately, most bundlers have tree shaking enabled by default because it reduces bundle size without changing the code behavior."})}),"\n",(0,l.jsxs)(s.h2,{id:"the-build-time-cost",children:[(0,l.jsx)(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#the-build-time-cost",children:(0,l.jsx)(s.span,{className:"icon icon-link"})}),"The build-time cost"]}),"\n",(0,l.jsx)(s.p,{children:"Barrel files are one of the key reasons why tooling is slow in bigger projects. All of your modules are likely to load barrel files (the imports are nice, after all), and so are your modules hidden behind the barrel files. It can result in a graph of import statements, where each module depends on another one, and so on."}),"\n",(0,l.jsx)(s.p,{children:"The more files, the longer it takes for the bundler to resolve and manage them. Here are the execution times of the build script for both variants:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.strong,{children:"With barrel file:"})}),"\n"]}),"\n",(0,l.jsx)(s.pre,{className:"language-jsx",children:(0,l.jsxs)(s.code,{className:"language-jsx code-highlight",children:[(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"import"})," ",(0,l.jsxs)(s.span,{className:"token imports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"Button"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"@mui/material"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"export"})," ",(0,l.jsx)(s.span,{className:"token keyword",children:"function"})," ",(0,l.jsx)(s.span,{className:"token function",children:(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"App"})}),(0,l.jsx)(s.span,{className:"token punctuation",children:"("}),(0,l.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:["  ",(0,l.jsx)(s.span,{className:"token keyword control-flow",children:"return"})," ",(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"<"}),(0,l.jsx)(s.span,{className:"token class-name",children:"Button"})]}),(0,l.jsx)(s.span,{className:"token punctuation",children:">"})]}),(0,l.jsx)(s.span,{className:"token plain-text",children:"Text"}),(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"</"}),(0,l.jsx)(s.span,{className:"token class-name",children:"Button"})]}),(0,l.jsx)(s.span,{className:"token punctuation",children:">"})]}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"code-highlight",children:(0,l.jsx)(s.span,{className:"code-line",children:"Execution time: 0h:00m:10s sec\n"})})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.strong,{children:"Without barrel file:"})}),"\n"]}),"\n",(0,l.jsx)(s.pre,{className:"language-diff",children:(0,l.jsxs)(s.code,{className:"language-diff code-highlight",children:[(0,l.jsx)(s.span,{className:"code-line deleted",children:(0,l.jsxs)(s.span,{className:"token deleted-sign deleted",children:[(0,l.jsx)(s.span,{className:"token prefix deleted",children:"-"}),(0,l.jsx)(s.span,{className:"token line",children:'import { Button } from "@mui/material";\n'})]})}),(0,l.jsxs)(s.span,{className:"code-line inserted",children:[(0,l.jsx)(s.span,{className:"token deleted-sign deleted",children:(0,l.jsx)(s.span,{className:"token line"})}),(0,l.jsxs)(s.span,{className:"token inserted-sign inserted",children:[(0,l.jsx)(s.span,{className:"token prefix inserted",children:"+"}),(0,l.jsx)(s.span,{className:"token line",children:'import Button from "@mui/material/Button";\n'})]})]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token inserted-sign inserted",children:(0,l.jsx)(s.span,{className:"token line"})}),"\n"]}),(0,l.jsx)(s.span,{className:"code-line",children:"export function App() {\n"}),(0,l.jsx)(s.span,{className:"code-line",children:(0,l.jsxs)(s.span,{className:"token unchanged",children:[(0,l.jsx)(s.span,{className:"token prefix unchanged",children:" "}),(0,l.jsx)(s.span,{className:"token line",children:" return <Button>Text</Button>;\n"})]})}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token unchanged",children:(0,l.jsx)(s.span,{className:"token line"})}),"}\n"]})]})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"code-highlight",children:(0,l.jsx)(s.span,{className:"code-line",children:"Execution time: 0h:00m:7s sec\n"})})}),"\n",(0,l.jsx)(n,{type:"success",children:(0,l.jsxs)(s.p,{children:["The build time is ",(0,l.jsx)("u",{children:"30% faster"})," when not using a barrel file.",(0,l.jsx)("sup",{title:"In a real-world scenario, the build time will probably not decrease by that much.",children:"*"})]})}),"\n",(0,l.jsxs)(s.h2,{id:"the-test-time-cost",children:[(0,l.jsx)(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#the-test-time-cost",children:(0,l.jsx)(s.span,{className:"icon icon-link"})}),"The test-time cost"]}),"\n",(0,l.jsx)(s.p,{children:"In both articles (I highly recommend reading those):"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://dev.to/twynsicle/why-is-my-jest-test-suite-so-slow-1od",rel:"nofollow noopener noreferrer",target:"_blank",children:"“Why is My Jest Test Suite So Slow?”"})," by Steven Lemon, and"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://marvinh.dev/blog/speeding-up-javascript-ecosystem-part-7/",rel:"nofollow noopener noreferrer",target:"_blank",children:"”Speeding up the JavaScript ecosystem - The barrel file debacle”"})," by Marvin Hagemeister"]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:"…the conclusion is the same: barrel files slow down tests."}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:["The problem is that Jest has no idea where the component we’re importing is located. The barrel file has intentionally obfuscated that fact. So when Jest hits a barrel file, it must load every export referenced inside it. This behavior quickly gets out of hand for large libraries like ",(0,l.jsx)(s.code,{children:"@mui/material"}),". We’re looking for a single button and end up loading hundreds of additional files. – Steven Lemon in ",(0,l.jsx)(s.a,{href:"https://dev.to/twynsicle/why-is-my-jest-test-suite-so-slow-1od",rel:"nofollow noopener noreferrer",target:"_blank",children:"“Why is My Jest Test Suite So Slow?”"})]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:"Let’s run the same test suite on two modules:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.strong,{children:"Importing from barrel file:"})}),"\n"]}),"\n",(0,l.jsx)(s.pre,{className:"language-jsx",children:(0,l.jsxs)(s.code,{className:"language-jsx code-highlight",children:[(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"import"})," ",(0,l.jsxs)(s.span,{className:"token imports",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"Button"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"}"})]})," ",(0,l.jsx)(s.span,{className:"token keyword module",children:"from"})," ",(0,l.jsx)(s.span,{className:"token string",children:'"@mui/material"'}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token keyword module",children:"export"})," ",(0,l.jsx)(s.span,{className:"token keyword",children:"function"})," ",(0,l.jsx)(s.span,{className:"token function",children:(0,l.jsx)(s.span,{className:"token maybe-class-name",children:"App"})}),(0,l.jsx)(s.span,{className:"token punctuation",children:"("}),(0,l.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,l.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:["  ",(0,l.jsx)(s.span,{className:"token keyword control-flow",children:"return"})," ",(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"<"}),(0,l.jsx)(s.span,{className:"token class-name",children:"Button"})]}),(0,l.jsx)(s.span,{className:"token punctuation",children:">"})]}),(0,l.jsx)(s.span,{className:"token plain-text",children:"Text"}),(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsxs)(s.span,{className:"token tag",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"</"}),(0,l.jsx)(s.span,{className:"token class-name",children:"Button"})]}),(0,l.jsx)(s.span,{className:"token punctuation",children:">"})]}),(0,l.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsxs)(s.code,{className:"code-highlight",children:[(0,l.jsx)(s.span,{className:"code-line",children:"> node scripts/test.js\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsx)(s.span,{className:"code-line",children:" PASS  src/App.test.js\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"  ✓ renders button (25 ms)\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"Test Suites: 1 passed, 1 total\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"Tests:       1 passed, 1 total\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"Time:        1.717 s, estimated 2 s\n"})]})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.strong,{children:"Importing directly from the module:"})}),"\n"]}),"\n",(0,l.jsx)(s.pre,{className:"language-diff",children:(0,l.jsxs)(s.code,{className:"language-diff code-highlight",children:[(0,l.jsx)(s.span,{className:"code-line deleted",children:(0,l.jsxs)(s.span,{className:"token deleted-sign deleted",children:[(0,l.jsx)(s.span,{className:"token prefix deleted",children:"-"}),(0,l.jsx)(s.span,{className:"token line",children:'import { Button } from "@mui/material";\n'})]})}),(0,l.jsxs)(s.span,{className:"code-line inserted",children:[(0,l.jsx)(s.span,{className:"token deleted-sign deleted",children:(0,l.jsx)(s.span,{className:"token line"})}),(0,l.jsxs)(s.span,{className:"token inserted-sign inserted",children:[(0,l.jsx)(s.span,{className:"token prefix inserted",children:"+"}),(0,l.jsx)(s.span,{className:"token line",children:'import Button from "@mui/material/Button";\n'})]})]}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token inserted-sign inserted",children:(0,l.jsx)(s.span,{className:"token line"})}),"\n"]}),(0,l.jsx)(s.span,{className:"code-line",children:"export function App() {\n"}),(0,l.jsx)(s.span,{className:"code-line",children:(0,l.jsxs)(s.span,{className:"token unchanged",children:[(0,l.jsx)(s.span,{className:"token prefix unchanged",children:" "}),(0,l.jsx)(s.span,{className:"token line",children:" return <Button>Text</Button>;\n"})]})}),(0,l.jsxs)(s.span,{className:"code-line",children:[(0,l.jsx)(s.span,{className:"token unchanged",children:(0,l.jsx)(s.span,{className:"token line"})}),"}\n"]})]})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsxs)(s.code,{className:"code-highlight",children:[(0,l.jsx)(s.span,{className:"code-line",children:"> node scripts/test.js\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsx)(s.span,{className:"code-line",children:" PASS  src/App.test.js\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"  ✓ renders button (29 ms)\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"Test Suites: 1 passed, 1 total\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"Tests:       1 passed, 1 total\n"}),(0,l.jsx)(s.span,{className:"code-line",children:"Time:        1.097 s\n"})]})}),"\n",(0,l.jsx)(n,{type:"success",children:(0,l.jsxs)(s.p,{children:["The test duration ",(0,l.jsx)("u",{children:"decreased from ~1.7 to ~1.1 seconds"})," when not importing from a barrel file."]})}),"\n",(0,l.jsx)(s.p,{children:"Notice the test suite itself took 25-29ms. The 600ms overhead comes from building the module graph. The cost of loading modules can change depending on the machine and the tooling."}),"\n",(0,l.jsxs)(s.p,{children:["In my lab setup, 10 independent tests running in 4 child processes would result in a ",(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsxs)(s.mfrac,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mn,{children:"0.6"}),(0,l.jsx)(s.mo,{children:"×"}),(0,l.jsx)(s.mn,{children:"10"})]}),(0,l.jsx)(s.mn,{children:"4"})]}),(0,l.jsx)(s.mo,{children:"="}),(0,l.jsx)(s.mn,{children:"1.5"})]}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\frac{0.6 \\times 10}{4} = 1.5"})]})})}),(0,l.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"1.1901em",verticalAlign:"-0.345em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(s.span,{className:"mfrac",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsxs)(s.span,{className:"vlist",style:{height:"0.8451em"},children:[(0,l.jsxs)(s.span,{style:{top:"-2.655em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(s.span,{className:"mord mtight",children:(0,l.jsx)(s.span,{className:"mord mtight",children:"4"})})})]}),(0,l.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(s.span,{style:{top:"-3.394em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(s.span,{className:"mord mtight",children:[(0,l.jsx)(s.span,{className:"mord mtight",children:"0.6"}),(0,l.jsx)(s.span,{className:"mbin mtight",children:"×"}),(0,l.jsx)(s.span,{className:"mord mtight",children:"10"})]})})]})]}),(0,l.jsx)(s.span,{className:"vlist-s",children:"​"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.345em"},children:(0,l.jsx)(s.span,{})})})]})}),(0,l.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(s.span,{className:"mrel",children:"="}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,l.jsx)(s.span,{className:"mord",children:"1.5"})]})]})]})," seconds overhead."]}),"\n",(0,l.jsxs)(s.h2,{id:"the-lint-time-cost",children:[(0,l.jsx)(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#the-lint-time-cost",children:(0,l.jsx)(s.span,{className:"icon icon-link"})}),"The lint-time cost"]}),"\n",(0,l.jsxs)(s.p,{children:["Barrel files affect the linting performance. Let’s say you use the ",(0,l.jsx)(s.code,{children:"import/no-cycle"})," rule from ",(0,l.jsx)(s.code,{children:"eslint-plugin-import"}),", which ensures there is no resolvable path back to a module via its dependencies by building a dependency graph. When it comes across a barrel file, the linting time will take longer because it has to resolve all the exports from the barrel file."]}),"\n",(0,l.jsx)(n,{type:"info",children:(0,l.jsx)(s.p,{children:"Unlike testing, linting is done on a file basis, so the dependency graph is built for each file separately."})}),"\n",(0,l.jsxs)(s.h2,{id:"developer-experience",children:[(0,l.jsx)(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#developer-experience",children:(0,l.jsx)(s.span,{className:"icon icon-link"})}),"Developer experience"]}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:"Most (if not all) IDEs have autocomplete and IntelliSense - you can type the function name, and it will get the import right automatically."}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:["Having barrel files makes code navigation harder - ",(0,l.jsx)("kbd",{children:"CMD + click"})," navigates to the barrel file instead of the actual definition of the module."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.h2,{id:"conclusion",children:[(0,l.jsx)(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#conclusion",children:(0,l.jsx)(s.span,{className:"icon icon-link"})}),"Conclusion"]}),"\n",(0,l.jsxs)(s.p,{children:["As software engineers, we are implementing new features daily, and each one has to be covered by ",(0,l.jsx)(s.em,{children:"tests"}),". To do so, we use ",(0,l.jsx)(s.em,{children:"linters"})," to help us write better code faster. Then, we ",(0,l.jsx)(s.em,{children:"build"})," our app for a testing environment before releasing it to production (",(0,l.jsx)(s.em,{children:"another build"}),"), and so on…"]}),"\n",(0,l.jsx)(s.p,{children:"Builds, tests, and tooling will only get slower as the application grows. Avoiding barrel files can improve performance without compromising the architecture or the developer experience."})]})}var t=function(e){void 0===e&&(e={});const{wrapper:s}=Object.assign({},(0,c.a)(),e.components);return s?(0,l.jsx)(s,Object.assign({},e,{children:(0,l.jsx)(i,e)})):i(e)};var o=n(4361),r=n(8029),d=n(8875),h=n(180),m=n(5551),p=n(9213),x=n(3120),j=n(6026),u=n(2349),N=n(7123);function k(e){let{data:s,pageContext:n,children:a}=e;const i=n.data,{frontmatter:t,tableOfContents:u}=i,{slug:k,timeToRead:g}=i.fields,{title:f,language:b,authors:y,datePublished:w,datePublishedMeta:v,dateUpdated:M,dateUpdatedMeta:B}=t,T=`${s.site.siteMetadata.siteUrl}/thumbnails/${(0,o.H)(k)}.png`;return(0,l.jsx)(m.A,{children:(0,l.jsx)(d.V,{children:(0,l.jsxs)("article",{className:"post",itemScope:!0,itemType:"http://schema.org/Article",lang:b,children:[(0,l.jsx)("meta",{itemProp:"image",content:T}),(0,l.jsx)("meta",{itemProp:"dateModified",content:B}),(0,l.jsx)("meta",{itemProp:"wordCount",content:`${g.words}`}),(0,l.jsxs)("header",{className:"post__header",children:[(0,l.jsx)("h1",{itemProp:"headline",children:f}),(0,l.jsxs)("p",{className:"post__header--metadata",children:[(0,l.jsx)(x.X,{data:y})," on ",(0,l.jsx)("time",{dateTime:v,itemProp:"datePublished",title:`Last modified on ${M}`,className:"post__header--date",children:w})," • ",(0,l.jsx)(j.t,{value:g.minutes})]})]}),(0,l.jsxs)("div",{className:"post__wrapper",children:[u.items?(0,l.jsx)("div",{className:"post__toc",children:(0,l.jsx)(N.o,{data:u})}):null,(0,l.jsxs)("div",{className:"post__content",children:[(0,l.jsx)("div",{itemProp:"articleBody",children:(0,l.jsx)(c.Z,{components:{Alert:r.b,Newsletter:p.m},children:a})}),(0,l.jsx)(h.$,{lang:b})]})]})]})})})}function g(e){return a.createElement(k,e,a.createElement(t,e))}function f(e){let{data:s,pageContext:n}=e;const a=n.data,c=a.fields.slug,{excerpt:i}=a,{title:t,description:r}=a.frontmatter,d=s.site.siteMetadata.siteUrl,h=`${d}/thumbnails/${(0,o.H)(c)}.png`;return(0,l.jsx)(u.H,{url:`${d}${c}`,title:t,image:h,description:r||i,children:(0,l.jsx)("html",{className:"smooth-scroll"})})}}}]);
//# sourceMappingURL=component---src-templates-blog-post-tsx-content-file-path-content-blog-pitfalls-of-barrel-files-in-javascript-modules-index-md-14b0a0a0c54e37e51c2c.js.map