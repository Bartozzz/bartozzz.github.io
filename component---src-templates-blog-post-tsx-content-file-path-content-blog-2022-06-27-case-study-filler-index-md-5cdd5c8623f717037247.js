"use strict";(self.webpackChunklaniewski_me=self.webpackChunklaniewski_me||[]).push([[439],{8727:function(n,s,a){a.r(s),a.d(s,{Head:function(){return x},default:function(){return f}});var t=a(7294),p=a(5893),e=a(1151);function o(n){const s=Object.assign({p:"p",a:"a",h2:"h2",em:"em",blockquote:"blockquote",ol:"ol",li:"li",ul:"ul",h3:"h3",code:"code",span:"span",h4:"h4",strong:"strong"},(0,e.ah)(),n.components),{Formula:a,Alert:t}=s;return t||l("Alert",!0),a||l("Formula",!0),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(s.p,{children:[(0,p.jsx)(s.a,{href:"https://filler.laniewski.me/",children:"Filler"})," is the first mobile game I ever created with React Native. It started as an experiment to learn more about algorithms, animations and the platform itself."]}),"\n",(0,p.jsx)(s.h2,{id:"introduction",children:"Introduction"}),"\n",(0,p.jsxs)(s.p,{children:["I initially created Filler when I was ~15 years old. The idea came up as I was thinking of simple projects I could work on to learn more about web development and data structures. It was later on that I learned there was already a similar (and quite popular back in the '90s) game, called ",(0,p.jsx)(s.em,{children:'"Lights Out"'}),"."]}),"\n",(0,p.jsxs)(s.blockquote,{children:["\n",(0,p.jsxs)(s.p,{children:["Lights Out is an electronic game released by Tiger Electronics in 1995. The game consists of a 5 by 5 grid of lights. When the game starts, a random number or a stored pattern of these lights is switched on. Pressing any of the lights will toggle it and the adjacent lights. The goal of the puzzle is to switch all the lights off, preferably in as few button presses as possible. – ",(0,p.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Lights_Out_(game)",children:"Wikipedia"})]}),"\n"]}),"\n",(0,p.jsx)(s.p,{children:"There are, however, a few differences between the original and my game. In Filler:"}),"\n",(0,p.jsxs)(s.ol,{children:["\n",(0,p.jsxs)(s.li,{children:["grids can be of any size, not only ",(0,p.jsx)(a,{children:"5 \\times 5"}),";"]}),"\n",(0,p.jsx)(s.li,{children:"the goal is to switch all the lights on, not off;"}),"\n"]}),"\n",(0,p.jsx)(s.p,{children:"The technology stack is pretty standard for the React ecosystem:"}),"\n",(0,p.jsxs)(s.ul,{children:["\n",(0,p.jsx)(s.li,{children:(0,p.jsx)(s.a,{href:"https://expo.dev/",children:"Expo"})}),"\n",(0,p.jsx)(s.li,{children:(0,p.jsx)(s.a,{href:"https://www.typescriptlang.org/",children:"TypeScript"})}),"\n",(0,p.jsx)(s.li,{children:(0,p.jsx)(s.a,{href:"https://reactnavigation.org/",children:"React Navigation"})}),"\n",(0,p.jsx)(s.li,{children:(0,p.jsx)(s.a,{href:"https://styled-components.com/",children:"Styled Components"})}),"\n"]}),"\n",(0,p.jsx)(s.h2,{id:"development",children:"Development"}),"\n",(0,p.jsx)(s.h3,{id:"internationalization",children:"Internationalization"}),"\n",(0,p.jsxs)(s.p,{children:["I used ",(0,p.jsx)(s.a,{href:"https://docs.expo.dev/versions/latest/sdk/localization/",children:(0,p.jsx)(s.code,{children:"expo-localization"})})," and ",(0,p.jsx)(s.a,{href:"https://github.com/fnando/i18n-js",children:(0,p.jsx)(s.code,{children:"i18n-js"})})," to localize my application. The internationalization setup is pretty straightforward:"]}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Localization <span class="token keyword">from</span> <span class="token string">"expo-localization"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> i18n <span class="token keyword">from</span> <span class="token string">"i18n-js"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> en <span class="token keyword">from</span> <span class="token string">"./strings/en.json"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> fr <span class="token keyword">from</span> <span class="token string">"./strings/fr.json"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> pl <span class="token keyword">from</span> <span class="token string">"./strings/pl.json"</span><span class="token punctuation">;</span>\n\ni18n<span class="token punctuation">.</span>fallbacks <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\ni18n<span class="token punctuation">.</span>translations <span class="token operator">=</span> <span class="token punctuation">{</span> en<span class="token punctuation">,</span> pl<span class="token punctuation">,</span> fr <span class="token punctuation">}</span><span class="token punctuation">;</span>\ni18n<span class="token punctuation">.</span>defaultLocale <span class="token operator">=</span> <span class="token string">"en"</span><span class="token punctuation">;</span>\ni18n<span class="token punctuation">.</span>locale <span class="token operator">=</span> Localization<span class="token punctuation">.</span>locale<span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token punctuation">{</span> i18n <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",(0,p.jsxs)(s.p,{children:["…then, I could simply import ",(0,p.jsx)(s.code,{children:"i18n"})," and use it in the application as follows:"]}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">"menu.campaignButton"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span></code></pre></div>'}}),"\n",(0,p.jsxs)(s.p,{children:["To make my tests independant of the translations, I mocked the ",(0,p.jsx)(s.code,{children:"i18n-js"})," library and made the ",(0,p.jsx)(s.code,{children:"i18n.t"})," function return the translation key instead of the translation itself:"]}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts">jest<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">"i18n-js"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    <span class="token operator">...</span>jest<span class="token punctuation">.</span><span class="token function">requireActual</span><span class="token punctuation">(</span><span class="token string">"i18n-js"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    t<span class="token operator">:</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">=></span> key<span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",(0,p.jsx)(s.p,{children:"…having that, I could safely update the copy without breaking the integration tests:"}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"should reset the board on \'Reset\' button click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> view <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Game</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  fireEvent<span class="token punctuation">.</span><span class="token function">press</span><span class="token punctuation">(</span>view<span class="token punctuation">.</span><span class="token function">getByText</span><span class="token punctuation">(</span><span class="token string">"header.resetBtn"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// …</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",(0,p.jsx)(s.p,{children:"I was not afraid to break anything in the user interface because my application contains visual regression tests. It allows me to ensure that my application appears to the end-user as it was originally intended to and I can catch visual regressions with ease."}),"\n",(0,p.jsx)(s.h3,{id:"animations",children:"Animations"}),"\n",(0,p.jsxs)(s.p,{children:["I used ",(0,p.jsx)(s.a,{href:"https://github.com/software-mansion/react-native-reanimated",children:(0,p.jsx)(s.code,{children:"react-native-reanimated"})})," to create all animations in the game. The main reason behind this choice was that the animations run on the native thread – it's a great animation library performance-wise. It comes with an imperative and a declarative API."]}),"\n",(0,p.jsx)(s.h4,{id:"imperative-api",children:"Imperative API"}),"\n",(0,p.jsxs)(s.p,{children:["I used the imperative functions and hooks for the ",(0,p.jsx)(s.code,{children:"GridCell"})," component. I wanted to interpolate between two colors based on the ",(0,p.jsx)(s.code,{children:"checked"})," prop. It was possible thanks to the ",(0,p.jsx)(s.code,{children:"interpolateColor"})," helper:"]}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight has-highlighted-lines" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">function</span> <span class="token function">GridCell</span><span class="token punctuation">(</span><span class="token punctuation">{</span> checked <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> checked<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> colorProgress <span class="token operator">=</span> <span class="token function">useSharedValue</span><span class="token punctuation">(</span>checked <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n  <span class="token comment">// Interpolate between `empty` and `checked` color based on progress:</span>\n<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> animatedStyles <span class="token operator">=</span> <span class="token function">useAnimatedStyle</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    backgroundColor<span class="token operator">:</span> <span class="token function">interpolateColor</span><span class="token punctuation">(</span></span><span class="gatsby-highlight-code-line">      colorProgress<span class="token punctuation">.</span>value<span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">      <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">      <span class="token punctuation">[</span>theme<span class="token punctuation">.</span>emptyCellColor<span class="token punctuation">,</span> theme<span class="token punctuation">.</span>checkedCellColor<span class="token punctuation">]</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>theme<span class="token punctuation">,</span> colorProgress<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n  <span class="token comment">// Change progress to 0-1 on `checked` change:</span>\n  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n<span class="gatsby-highlight-code-line">    colorProgress<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">withTiming</span><span class="token punctuation">(</span>checked <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>checked<span class="token punctuation">,</span> colorProgress<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Cell</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>animatedStyles<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n",(0,p.jsx)(s.h4,{id:"declarative-api",children:"Declarative API"}),"\n",(0,p.jsx)(s.p,{children:"There's also a higher-level API that I used to progressively reveal content on the success screen. I didn't need anything fancy here, just some entering animations with delays and the declarative API does a great job for such things:"}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight has-highlighted-lines" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">function</span> <span class="token function">ScoreStars</span><span class="token punctuation">(</span><span class="token punctuation">{</span> score <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> score<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> delay <span class="token operator">=</span> <span class="token number">250</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Stars</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="gatsby-highlight-code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Animated.View</span></span> <span class="token attr-name">entering</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>Swing<span class="token punctuation">.</span><span class="token function">delay</span><span class="token punctuation">(</span>delay <span class="token operator">*</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span></span><span class="token plain-text">        </span><span class="token punctuation">{</span>score <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrayStar</span></span> <span class="token punctuation">/></span></span> <span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GoldStar</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span><span class="token plain-text"></span>\n<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Animated.View</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="token plain-text"></span>\n<span class="gatsby-highlight-code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Animated.View</span></span> <span class="token attr-name">entering</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>Swing<span class="token punctuation">.</span><span class="token function">delay</span><span class="token punctuation">(</span>delay <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span></span><span class="token plain-text">        </span><span class="token punctuation">{</span>score <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrayStar</span></span> <span class="token punctuation">/></span></span> <span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GoldStar</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span><span class="token plain-text"></span>\n<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Animated.View</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="token plain-text"></span>\n<span class="gatsby-highlight-code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Animated.View</span></span> <span class="token attr-name">entering</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>Swing<span class="token punctuation">.</span><span class="token function">delay</span><span class="token punctuation">(</span>delay <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span></span><span class="token plain-text">        </span><span class="token punctuation">{</span>score <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrayStar</span></span> <span class="token punctuation">/></span></span> <span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GoldStar</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span><span class="token plain-text"></span>\n<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Animated.View</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Stars</span></span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",(0,p.jsxs)(s.p,{children:["…where ",(0,p.jsx)(s.code,{children:"Swing"})," is a custom ",(0,p.jsx)(s.a,{href:"https://docs.swmansion.com/react-native-reanimated/docs/api/LayoutAnimations/keyframeAnimations/",children:"keyframe"})," I created:"]}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">const</span> <span class="token function-variable function">Swing</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>\n  <span class="token keyword">new</span> <span class="token class-name">Keyframe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> rotate<span class="token operator">:</span> <span class="token string">"0deg"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token number">20</span><span class="token operator">:</span> <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> rotate<span class="token operator">:</span> <span class="token string">"15deg"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token number">40</span><span class="token operator">:</span> <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> rotate<span class="token operator">:</span> <span class="token string">"-10deg"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token number">60</span><span class="token operator">:</span> <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> rotate<span class="token operator">:</span> <span class="token string">"5deg"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token number">80</span><span class="token operator">:</span> <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> rotate<span class="token operator">:</span> <span class="token string">"-5deg"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token number">100</span><span class="token operator">:</span> <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> rotate<span class="token operator">:</span> <span class="token string">"0deg"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",(0,p.jsx)(s.h3,{id:"monetization",children:"Monetization"}),"\n",(0,p.jsx)(s.p,{children:"After the gameplay was implemented, I started working on integrating ads into the application using Google's AdMob platform. The monetization model is pretty standard in the mobile industry. I decided to show:"}),"\n",(0,p.jsxs)(s.ul,{children:["\n",(0,p.jsx)(s.li,{children:"an Interstitial Ad when the user completes a level (cap at 1 impression / 5 minutes / user);"}),"\n",(0,p.jsx)(s.li,{children:"a Rewarded Ad to unlock the solution w/ solver."}),"\n"]}),"\n",(0,p.jsxs)(s.p,{children:["I used ",(0,p.jsx)(s.a,{href:"https://github.com/invertase/react-native-google-mobile-ads",children:(0,p.jsx)(s.code,{children:"react-native-google-mobile-ads"})})," (and had a chance to contribute a little bit to the library as well!) to implement the advertising."]}),"\n",(0,p.jsx)(s.h4,{id:"interstitial-ad",children:"Interstitial Ad"}),"\n",(0,p.jsx)(s.p,{children:"I created a hook to easily check whether the advertisement has been watched or not."}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">function</span> <span class="token function">useInterstitialAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> isLoaded<span class="token punctuation">,</span> isClosed<span class="token punctuation">,</span> error<span class="token punctuation">,</span> load<span class="token punctuation">,</span> show <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">nativeUseInterstitialAd</span><span class="token punctuation">(</span>\n    <span class="token string">"&lt;AD_UNIT_ID>"</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span>\n      requestNonPersonalizedAdsOnly<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> isError <span class="token operator">=</span> error <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> isAdWatched <span class="token operator">=</span> isClosed <span class="token operator">||</span> isError<span class="token punctuation">;</span>\n\n  <span class="token comment">// Start loading the interstitial straight away:</span>\n  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>load<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token comment">// Show the interstitial once loaded:</span>\n  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>isLoaded<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>isLoaded<span class="token punctuation">,</span> show<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">{</span> isAdWatched <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n",(0,p.jsx)(s.p,{children:'…then, I could very simply disable the "Next level" button until the ad has been watched:'}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">const</span> <span class="token punctuation">{</span> isAdWatched <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useInterstitialAd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">disabled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token operator">!</span>isAdWatched<span class="token punctuation">}</span></span> <span class="token attr-name">onPress</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleExit<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  Next level\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span></code></pre></div>'}}),"\n",(0,p.jsx)(s.h4,{id:"rewarded-ad",children:"Rewarded Ad"}),"\n",(0,p.jsx)(s.p,{children:"Rewarded ads need a trigger and an explicit user interaction to show. I decided to go with a React Render Props pattern for a nice DX:"}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">RewardedAd</span></span> <span class="token attr-name">onSuccess</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>showSolution<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span> trigger<span class="token punctuation">,</span> isAdLoading <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ActionButton</span></span> <span class="token attr-name">onPress</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>trigger<span class="token punctuation">}</span></span> <span class="token attr-name">processing</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>isAdLoading<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      Show solution\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ActionButton</span></span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">RewardedAd</span></span><span class="token punctuation">></span></span></code></pre></div>'}}),"\n",(0,p.jsxs)(s.p,{children:[(0,p.jsx)(s.code,{children:"RewardedAd"})," hides a lot of boilerplate, but basically, it listens for events and handles the various errors that can occur."]}),"\n",(0,p.jsx)(s.h2,{id:"challenges",children:"Challenges"}),"\n",(0,p.jsx)(s.h3,{id:"permissions",children:"Permissions"}),"\n",(0,p.jsx)(t,{type:"warning",children:(0,p.jsx)(s.p,{children:"By default, Expo adds a lot of unnecessary permission which can discourage the user from installing your application."})}),"\n",(0,p.jsxs)(s.p,{children:["Once released on Google Play, I noticed that the app had unnecessary permission listed. It required pretty much every permission available but needed none to work. To remove unused permissions, I had to modify ",(0,p.jsx)(s.code,{children:"android/app/src/main/AndroidManifest.xml"})," as follows (note the ",(0,p.jsx)(s.code,{children:'tools:node="remove"'})," on ",(0,p.jsx)(s.code,{children:"uses-permission"}),"):"]}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>tools</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/tools<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.VIBRATE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.INTERNET<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">tools:</span>node</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>remove<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.MODIFY_AUDIO_SETTINGS<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">tools:</span>node</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>remove<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.READ_EXTERNAL_STORAGE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">tools:</span>node</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>remove<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.READ_PHONE_STATE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">tools:</span>node</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>remove<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.RECORD_AUDIO<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">tools:</span>node</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>remove<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.SYSTEM_ALERT_WINDOW<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">tools:</span>node</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>remove<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.permission.WRITE_EXTERNAL_STORAGE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">></span></span></code></pre></div>'}}),"\n",(0,p.jsx)(s.h3,{id:"performance",children:"Performance"}),"\n",(0,p.jsxs)(s.p,{children:["I use my old ",(0,p.jsx)(s.a,{href:"https://www.gsmchoice.com/en/catalogue/asus/zenfone3maxzc520tl/",children:"Asus ZenFone 3 Max 5.2"})," as a benchmark – if a game works nicely on this device, I can sleep soundly because it means it will run on pretty much anything. My aim I always to get a stable 60 FPS for a nice user experience."]}),"\n",(0,p.jsx)(s.p,{children:"It was quite hard to achieve at first for several reasons:"}),"\n",(0,p.jsxs)(s.ol,{children:["\n",(0,p.jsxs)(s.li,{children:[(0,p.jsxs)(s.strong,{children:["Initially, I used ",(0,p.jsx)(s.a,{href:"https://github.com/oblador/react-native-animatable",children:(0,p.jsx)(s.code,{children:"react-native-animatable"})})," for animations:"]})," it had noticeably worse performance than ",(0,p.jsx)(s.code,{children:"react-native-reanimated"}),";"]}),"\n",(0,p.jsxs)(s.li,{children:[(0,p.jsx)(s.strong,{children:"There were some redundant re-renders:"})," once I memorized some expensive components and calculation results, it improved the performance;"]}),"\n",(0,p.jsxs)(s.li,{children:[(0,p.jsxs)(s.strong,{children:["I was using JSC instead of ",(0,p.jsx)(s.a,{href:"https://engineering.fb.com/2019/07/12/android/hermes/",children:"Hermes"}),":"]})," once I migrated to Hermes, the performance improved greatly. Also, TTI, application size and memory utilization decreased a lot;"]}),"\n"]}),"\n",(0,p.jsx)(s.p,{children:"It turned out that React Native with Hermes can perform well enough to provide a nice UX, even on my old phone."}),"\n",(0,p.jsx)(s.h3,{id:"sounds",children:"Sounds"}),"\n",(0,p.jsxs)(s.p,{children:["There's an issue with playing the same ",(0,p.jsx)(s.a,{href:"https://docs.expo.dev/versions/latest/sdk/audio/",children:(0,p.jsx)(s.code,{children:"Audio"})})," multiple times: the sound works well the first time, but the other times it seems that the sound isn't playing from the start but with a shift of some milliseconds."]}),"\n",(0,p.jsxs)(s.p,{children:["The solution I use is to preload multiple copies of ",(0,p.jsx)(s.a,{href:"https://docs.expo.dev/versions/latest/sdk/audio/",children:(0,p.jsx)(s.code,{children:"Audio"})})," and play the next sample when needed. My implementation looks as follows:"]}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Audio <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"expo-av"</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> AVPlaybackSource <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"expo-av/build/AV"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Sound</span> <span class="token punctuation">{</span>\n  <span class="token keyword">static</span> <span class="token constant">COPIES</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n  <span class="token keyword">static</span> <span class="token constant">INDEX</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n  <span class="token keyword">static</span> assets<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Audio<span class="token punctuation">.</span>Sound<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">static</span> <span class="token function">loadAsync</span><span class="token punctuation">(</span>library<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> AVPlaybackSource<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> promisesForCopies <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>library<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>\n      <span class="token punctuation">(</span><span class="token punctuation">[</span>name<span class="token punctuation">,</span> path<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">,</span> AVPlaybackSource<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token comment">// Make n = Sound.COPIES copies:</span>\n        <span class="token keyword">return</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token function">Array</span><span class="token punctuation">(</span>Sound<span class="token punctuation">.</span><span class="token constant">COPIES</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n          <span class="token keyword">const</span> soundNameWithIndex <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n\n          Sound<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>soundNameWithIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Audio</span><span class="token punctuation">.</span><span class="token function">Sound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n          <span class="token keyword">return</span> Sound<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>soundNameWithIndex<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">loadAsync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>promisesForCopies<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token function">play</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> volume <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">try</span> <span class="token punctuation">{</span>\n      Sound<span class="token punctuation">.</span><span class="token constant">INDEX</span> <span class="token operator">=</span> <span class="token punctuation">(</span>Sound<span class="token punctuation">.</span><span class="token constant">INDEX</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Sound<span class="token punctuation">.</span><span class="token constant">COPIES</span><span class="token punctuation">;</span>\n\n      <span class="token keyword">const</span> soundNameWithIndex <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Sound<span class="token punctuation">.</span><span class="token constant">INDEX</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n      <span class="token keyword">const</span> soundSample <span class="token operator">=</span> Sound<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>soundNameWithIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>soundSample<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">await</span> soundSample<span class="token punctuation">.</span><span class="token function">setVolumeAsync</span><span class="token punctuation">(</span>volume<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">await</span> soundSample<span class="token punctuation">.</span><span class="token function">playFromPositionAsync</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sound </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> does not exist</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token comment">// Silent error…</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n",(0,p.jsx)(s.h3,{id:"solver",children:"Solver"}),"\n",(0,p.jsx)(s.p,{children:"I wanted to create a solver to monetize the game. It turned out to be quite a popular problem with a lot of resources online, so I won't go into much details. It just required a bit of linear algebra."}),"\n",(0,p.jsxs)(s.p,{children:["A board can be modeled mathematically as a vector over ",(0,p.jsx)(a,{children:"\\mathbb{F}_2"}),", a ",(0,p.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/GF(2)",children:"field"})," containing only the elements 0 and 1 (for light on and off respectively). We can write each possible board position and each possible move as a vector over ",(0,p.jsx)(a,{children:"\\mathbb{F}_2"}),". That means that:"]}),"\n",(0,p.jsxs)(s.ul,{children:["\n",(0,p.jsx)(s.li,{children:"pressing a cell an even number of times has no effect;"}),"\n",(0,p.jsx)(s.li,{children:"the order in which we press the cells does not matter;"}),"\n"]}),"\n",(0,p.jsxs)(s.p,{children:["To solve the board, we need to find a combination of these move vectors which adds up to give the current board, since that will cancel with the board, turning all of the lights on. There is a systematic way of solving this kind of vector problem called ",(0,p.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Gaussian_elimination",children:"Gaussian Elimination"}),"."]}),"\n",(0,p.jsx)(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">solve</span><span class="token punctuation">(</span>width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> state<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> moveVector <span class="token operator">=</span> <span class="token function">buildMoveVector</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> moveMatrix <span class="token operator">=</span> <span class="token function">buildMoveMatrix</span><span class="token punctuation">(</span>moveVector<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> solution <span class="token operator">=</span> <span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token function">rref</span><span class="token punctuation">(</span>moveMatrix<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> solution<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n",(0,p.jsxs)(s.p,{children:["A nice video explaining this in detail can be found ",(0,p.jsx)(s.a,{href:"https://www.youtube.com/watch?v=oCHCD_-nhg4",children:"here"}),"."]}),"\n",(0,p.jsx)(s.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,p.jsx)(s.p,{children:"It was a fun experience to rebuild the same game several years later after gathering all of my commercial experience and still being able to learn new things along the journey. So far, I've got 200+ downloads and generated $0.20 in ad revenue, but hey, the learnings are priceless!"}),"\n"]})}var c=function(n){void 0===n&&(n={});const{wrapper:s}=Object.assign({},(0,e.ah)(),n.components);return s?(0,p.jsx)(s,Object.assign({},n,{children:(0,p.jsx)(o,n)})):o(n)};function l(n,s){throw new Error("Expected "+(s?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}var i=a(8029),u=a(8875),r=a(180),k=a(317),d=a(5551),h=a(2349),m=a(7123);function g(n){let{pageContext:s,children:a}=n;const t=s.data,{frontmatter:o,tableOfContents:c}=t,{title:l,datePublished:h,language:g,authors:f}=o;return(0,p.jsx)(d.A,{children:(0,p.jsx)(u.V,{children:(0,p.jsxs)("article",{className:"post",itemScope:!0,itemType:"http://schema.org/Article",lang:g,children:[(0,p.jsxs)("header",{className:"post__header",children:[(0,p.jsx)("h1",{itemProp:"headline",children:l}),(0,p.jsx)("time",{dateTime:h,itemProp:"datePublished",children:h}),null!=f&&f.length?(0,p.jsx)("ul",{className:"visually-hidden",children:f.map((n=>(0,p.jsx)("li",{children:(0,p.jsx)("p",{itemProp:"author",children:n})},n)))}):null]}),(0,p.jsxs)("div",{className:"post__wrapper",children:[(0,p.jsx)("div",{className:"post__toc",children:(0,p.jsx)(m.o,{data:c})}),(0,p.jsxs)("div",{className:"post__content",children:[(0,p.jsx)("div",{itemProp:"articleBody",children:(0,p.jsx)(e.Zo,{components:{Alert:i.b,Formula:k.S},children:a})}),(0,p.jsx)(r.$,{lang:g})]})]})]})})})}function f(n){return t.createElement(g,n,t.createElement(c,n))}function x(n){let{pageContext:s}=n;const a=s.data,{excerpt:t}=a,{title:e,description:o}=a.frontmatter;return(0,p.jsx)(h.H,{title:e,description:o||t})}},8029:function(n,s,a){a.d(s,{b:function(){return r}});var t={};a.r(t),a.d(t,{alert:function(){return p},alert__failure:function(){return e},alert__info:function(){return o},alert__success:function(){return c},alert__warning:function(){return l}});var p="index-module--alert--af406",e="index-module--alert__failure--c7bcc",o="index-module--alert__info--cfa0f",c="index-module--alert__success--14443",l="index-module--alert__warning--5ba8e",i=a(7294),u=a(5893);function r(n){let{children:s,as:a="aside",type:e="info",...o}=n;const c=n=>i.createElement(a,n);return(0,u.jsx)(c,{...o,className:`${p} ${t[`alert__${e}`]}`,children:s})}},180:function(n,s,a){a.d(s,{$:function(){return o}});var t=a(7294),p=a(1711),e=a(5893);function o(n){let{lang:s="en"}=n;const a=t.useRef(),[o]=(0,p.F)(),c=null!==o;return t.useLayoutEffect((()=>{const n=a.current;if(!n||!c)return;const t=function(n){let{theme:s,lang:a}=n;const t="undefined"!=typeof window?window.location.origin:"";return`\n    <script src="https://giscus.app/client.js"\n      data-repo="Bartozzz/bartozzz.github.io"\n      data-repo-id="MDEwOlJlcG9zaXRvcnkyNDk1MjY5MQ=="\n      data-category="Discussion"\n      data-category-id="DIC_kwDOAXy_c84CAHzq"\n      data-mapping="pathname"\n      data-reactions-enabled="1"\n      data-emit-metadata="0"\n      data-theme="${"dark"===s?`${t}/discussion-dark.css`:`${t}/discussion-light.css`}"\n      data-lang="${a}"\n      crossorigin="anonymous"\n      async>\n    <\/script>\n  `}({theme:o,lang:s}),p=document.createRange().createContextualFragment(t);return null==n||n.appendChild(p),()=>{n.innerHTML=""}}),[c]),t.useEffect((()=>{const n="undefined"!=typeof window?window.location.origin:"";!function(n){const s=document.querySelector("iframe.giscus-frame");s&&s.contentWindow.postMessage({giscus:n},"https://giscus.app")}({setConfig:{theme:"dark"===o?`${n}/discussion-dark.css`:`${n}/discussion-light.css`,lang:s}})}),[o,s]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:`comments--${o}`,ref:a})})}},317:function(n,s,a){a.d(s,{S:function(){return o}});var t=a(7294),p=a(1008);function e(){return(e=Object.assign||function(n){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(n[t]=a[t])}return n}).apply(this,arguments)}const o=(0,t.memo)((function(n){var s=n.children,a=n.math,o=n.block,c=n.errorColor,l=n.renderError,i=n.settings,u=n.as,r=function(n,s){if(null==n)return{};var a,t,p={},e=Object.keys(n);for(t=0;t<e.length;t++)s.indexOf(a=e[t])>=0||(p[a]=n[a]);return p}(n,["children","math","block","errorColor","renderError","settings","as"]),k=u||(o?"div":"span"),d=null!=s?s:a,h=(0,t.useState)({innerHtml:""}),m=h[0],g=h[1];return(0,t.useEffect)((function(){try{var n=p.Z.renderToString(d,e({displayMode:!!o,errorColor:c,throwOnError:!!l},i));g({innerHtml:n})}catch(n){if(!(n instanceof p.Z.ParseError||n instanceof TypeError))throw n;g(l?{errorElement:l(n)}:{innerHtml:n.message})}}),[o,d,c,l,i]),"errorElement"in m?m.errorElement:t.createElement(k,Object.assign({},r,{dangerouslySetInnerHTML:{__html:m.innerHtml}}))}))},7123:function(n,s,a){a.d(s,{o:function(){return h}});var t=a(5785),p="index-module--toc--16eb9",e="index-module--toc__ellipsis--2a1a1",o="index-module--toc__link--1571c",c="index-module--toc__link--active--2b793",l="index-module--toc__list--19652",i="index-module--toc__title--91e5c",u=a(7294),r=a(1883),k=a(5893);function d(n){return n.flatMap((n=>{let{url:s,title:a,items:p}=n;return[{url:s,title:a}].concat((0,t.Z)(p?d(p):[]))}))}function h(n){let{data:s}=n;const[a,t]=u.useState(),e=d(s.items);return console.log({data:s,activeHeadingId:a}),u.useEffect((()=>{const n=new IntersectionObserver((n=>{n.forEach((n=>{n.isIntersecting&&t(`#${n.target.id}`)}))}),{rootMargin:"0% 0% -80% 0%"});return e.forEach((s=>{const a=document.querySelector(s.url);a&&n.observe(a)})),()=>{e.forEach((s=>{const a=document.querySelector(s.url);a&&n.unobserve(a)}))}}),[e]),(0,k.jsxs)("nav",{"aria-label":"On this page",className:p,children:[(0,k.jsx)("p",{className:i,children:"Contents"}),(0,k.jsx)(m,{tree:s,activeSlug:a})]})}function m(n){let{tree:s,activeSlug:a}=n;return(0,k.jsx)("ol",{className:l,children:s.items.map((n=>{var s;return(0,k.jsxs)("li",{children:[(0,k.jsx)(r.Link,{to:n.url,title:n.title,className:`${o} ${a===n.url?c:""}`,children:(0,k.jsx)("span",{className:e,children:n.title})}),(null===(s=n.items)||void 0===s?void 0:s.length)>0&&(0,k.jsx)(m,{tree:n,activeSlug:a})]},n.url)}))})}},1151:function(n,s,a){a.d(s,{Zo:function(){return c},ah:function(){return e}});var t=a(7294);const p=t.createContext({});function e(n){const s=t.useContext(p);return t.useMemo((()=>"function"==typeof n?n(s):{...s,...n}),[s,n])}const o={};function c({components:n,children:s,disableParentContext:a}){let c;return c=a?"function"==typeof n?n({}):n||o:e(n),t.createElement(p.Provider,{value:c},s)}}}]);
//# sourceMappingURL=component---src-templates-blog-post-tsx-content-file-path-content-blog-2022-06-27-case-study-filler-index-md-5cdd5c8623f717037247.js.map