"use strict";(self.webpackChunklaniewski_me=self.webpackChunklaniewski_me||[]).push([[657],{7848:function(e,n,s){s.r(n),s.d(n,{Head:function(){return g},default:function(){return f}});var a=s(7294),t=s(5893),o=s(1151);function i(e){const n=Object.assign({p:"p",a:"a",em:"em",h2:"h2",span:"span",blockquote:"blockquote",code:"code",h3:"h3",pre:"pre"},(0,o.a)(),e.components),{Newsletter:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Newsletter",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["There are more than ",(0,t.jsx)(n.a,{href:"https://github.com/facebook/flow/network/dependents",rel:"nofollow noopener noreferrer",target:"_blank",children:"31000 repositories on GitHub"})," using Flow but only a few export Flow definitions. In this article, we will see how to export Flow definitions for a module. Before getting started, I encourage you to read my previous article about „",(0,t.jsx)(n.em,{children:(0,t.jsx)(n.a,{href:"/blog/2018-04-29-publishing-packages-to-npm/",children:"Publishing tree shaking friendly packages to npm"})}),"”."]}),"\n",(0,t.jsxs)(n.h2,{id:"what-is-flow",children:[(0,t.jsx)(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#what-is-flow",children:(0,t.jsx)(n.span,{className:"icon icon-link"})}),"What is Flow?"]}),"\n",(0,t.jsxs)(n.p,{children:["You’ve probably already seen ",(0,t.jsx)(n.a,{href:"https://www.destroyallsoftware.com/talks/wat",rel:"nofollow noopener noreferrer",target:"_blank",children:"Gary’s talk from CodeMash 2012"})," about JavaScript. With Flow in your hands, there should be no more „",(0,t.jsx)(n.em,{children:"wat’s"}),"”."]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["Flow is a static type checker for your JavaScript code. It does a lot of work to make you more productive. Making you code faster, smarter, more confidently, and to a bigger scale. – ",(0,t.jsx)(n.a,{href:"https://flow.org/en/docs/getting-started/",rel:"nofollow noopener noreferrer",target:"_blank",children:"Introduction to type checking with Flow"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Flow was first presented at the ",(0,t.jsx)(n.a,{href:"https://atscaleconference.com/",rel:"nofollow noopener noreferrer",target:"_blank",children:"Scale Conference"})," in 2014 by Facebook. Its main goal was to add additional syntax to JavaScript language to prevent type errors and give developers a more concise idea about bugs that can occur in their code. It also gives a way for IDEs to provide a better environment for spotting errors in real-time."]}),"\n",(0,t.jsxs)(n.h2,{id:"how-to-export-flow-definitions",children:[(0,t.jsx)(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#how-to-export-flow-definitions",children:(0,t.jsx)(n.span,{className:"icon icon-link"})}),"How to export Flow definitions?"]}),"\n",(0,t.jsxs)(n.p,{children:["There are currently two ways of exporting Flow definitions. The easiest one is by exporting ",(0,t.jsx)(n.code,{children:".js.flow"})," files within your package. However, if you are planning on versioning your definitions, you should contribute to the ",(0,t.jsx)(n.code,{children:"flow-typed"})," repository instead."]}),"\n",(0,t.jsxs)(n.h3,{id:"exporting-flow-files",children:[(0,t.jsx)(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#exporting-flow-files",children:(0,t.jsx)(n.span,{className:"icon icon-link"})}),"Exporting Flow files"]}),"\n",(0,t.jsxs)(n.p,{children:["All you have to do is copy source files (i.e. not transpiled by ",(0,t.jsx)(n.em,{children:"Flow"})," and ",(0,t.jsx)(n.em,{children:"Babel"}),") to the ",(0,t.jsx)(n.code,{children:".js.flow"})," format and include them with the library. Let’s start by installing the required npm dependencies using the following command:"]}),"\n",(0,t.jsx)(n.pre,{className:"language-bash",children:(0,t.jsx)(n.code,{className:"language-bash code-highlight",children:(0,t.jsxs)(n.span,{className:"code-line",children:["$ ",(0,t.jsx)(n.span,{className:"token function",children:"npm"})," ",(0,t.jsx)(n.span,{className:"token function",children:"install"})," --save-dev glob fs-extra\n"]})})}),"\n",(0,t.jsxs)(n.p,{children:["Once installed, we can write a script that will copy all source files to the ",(0,t.jsx)(n.code,{children:"/dest"})," directory and change their extension to ",(0,t.jsx)(n.code,{children:".js.flow"}),":"]}),"\n",(0,t.jsx)(n.pre,{className:"language-javascript",children:(0,t.jsxs)(n.code,{className:"language-javascript code-highlight",children:[(0,t.jsxs)(n.span,{className:"code-line",children:[(0,t.jsx)(n.span,{className:"token comment",children:"// File: ./bin/defs.js"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:[(0,t.jsx)(n.span,{className:"token keyword module",children:"import"})," ",(0,t.jsxs)(n.span,{className:"token imports",children:[(0,t.jsx)(n.span,{className:"token punctuation",children:"{"})," basename",(0,t.jsx)(n.span,{className:"token punctuation",children:","})," resolve ",(0,t.jsx)(n.span,{className:"token punctuation",children:"}"})]})," ",(0,t.jsx)(n.span,{className:"token keyword module",children:"from"})," ",(0,t.jsx)(n.span,{className:"token string",children:'"path"'}),(0,t.jsx)(n.span,{className:"token punctuation",children:";"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:[(0,t.jsx)(n.span,{className:"token keyword module",children:"import"})," ",(0,t.jsxs)(n.span,{className:"token imports",children:[(0,t.jsx)(n.span,{className:"token punctuation",children:"{"})," copy ",(0,t.jsx)(n.span,{className:"token punctuation",children:"}"})]})," ",(0,t.jsx)(n.span,{className:"token keyword module",children:"from"})," ",(0,t.jsx)(n.span,{className:"token string",children:'"fs-extra"'}),(0,t.jsx)(n.span,{className:"token punctuation",children:";"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:[(0,t.jsx)(n.span,{className:"token keyword module",children:"import"})," ",(0,t.jsx)(n.span,{className:"token imports",children:"glob"})," ",(0,t.jsx)(n.span,{className:"token keyword module",children:"from"})," ",(0,t.jsx)(n.span,{className:"token string",children:'"glob"'}),(0,t.jsx)(n.span,{className:"token punctuation",children:";"}),"\n"]}),(0,t.jsx)(n.span,{className:"code-line",children:"\n"}),(0,t.jsxs)(n.span,{className:"code-line",children:[(0,t.jsx)(n.span,{className:"token keyword",children:"async"})," ",(0,t.jsx)(n.span,{className:"token keyword",children:"function"})," ",(0,t.jsx)(n.span,{className:"token function",children:"copyFile"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),(0,t.jsx)(n.span,{className:"token parameter",children:"file"}),(0,t.jsx)(n.span,{className:"token punctuation",children:")"})," ",(0,t.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["  ",(0,t.jsx)(n.span,{className:"token keyword",children:"const"})," srcDir  ",(0,t.jsx)(n.span,{className:"token operator",children:"="})," ",(0,t.jsx)(n.span,{className:"token function",children:"resolve"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),"__dirname",(0,t.jsx)(n.span,{className:"token punctuation",children:","})," ",(0,t.jsx)(n.span,{className:"token string",children:'"../src"'}),(0,t.jsx)(n.span,{className:"token punctuation",children:")"}),(0,t.jsx)(n.span,{className:"token punctuation",children:";"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["  ",(0,t.jsx)(n.span,{className:"token keyword",children:"const"})," destDir ",(0,t.jsx)(n.span,{className:"token operator",children:"="})," ",(0,t.jsx)(n.span,{className:"token function",children:"resolve"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),"__dirname",(0,t.jsx)(n.span,{className:"token punctuation",children:","})," ",(0,t.jsx)(n.span,{className:"token string",children:'"../dest"'}),(0,t.jsx)(n.span,{className:"token punctuation",children:")"}),(0,t.jsx)(n.span,{className:"token punctuation",children:";"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["  ",(0,t.jsx)(n.span,{className:"token keyword",children:"const"})," fileDef ",(0,t.jsx)(n.span,{className:"token operator",children:"="})," ",(0,t.jsxs)(n.span,{className:"token template-string",children:[(0,t.jsx)(n.span,{className:"token template-punctuation string",children:"`"}),(0,t.jsxs)(n.span,{className:"token interpolation",children:[(0,t.jsx)(n.span,{className:"token interpolation-punctuation punctuation",children:"${"}),"file",(0,t.jsx)(n.span,{className:"token interpolation-punctuation punctuation",children:"}"})]}),(0,t.jsx)(n.span,{className:"token string",children:".flow"}),(0,t.jsx)(n.span,{className:"token template-punctuation string",children:"`"})]}),(0,t.jsx)(n.span,{className:"token punctuation",children:"."}),(0,t.jsx)(n.span,{className:"token method function property-access",children:"replace"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),"srcDir",(0,t.jsx)(n.span,{className:"token punctuation",children:","})," destDir",(0,t.jsx)(n.span,{className:"token punctuation",children:")"}),(0,t.jsx)(n.span,{className:"token punctuation",children:";"}),"\n"]}),(0,t.jsx)(n.span,{className:"code-line",children:"\n"}),(0,t.jsxs)(n.span,{className:"code-line",children:["  ",(0,t.jsx)(n.span,{className:"token keyword control-flow",children:"await"})," ",(0,t.jsx)(n.span,{className:"token function",children:"copy"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),"file",(0,t.jsx)(n.span,{className:"token punctuation",children:","})," fileDef",(0,t.jsx)(n.span,{className:"token punctuation",children:")"}),(0,t.jsx)(n.span,{className:"token punctuation",children:";"}),"\n"]}),(0,t.jsx)(n.span,{className:"code-line",children:"\n"}),(0,t.jsxs)(n.span,{className:"code-line",children:["  ",(0,t.jsx)(n.span,{className:"token console class-name",children:"console"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"."}),(0,t.jsx)(n.span,{className:"token method function property-access",children:"log"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),(0,t.jsxs)(n.span,{className:"token template-string",children:[(0,t.jsx)(n.span,{className:"token template-punctuation string",children:"`"}),(0,t.jsx)(n.span,{className:"token string",children:"Copied "}),(0,t.jsxs)(n.span,{className:"token interpolation",children:[(0,t.jsx)(n.span,{className:"token interpolation-punctuation punctuation",children:"${"}),"file",(0,t.jsx)(n.span,{className:"token interpolation-punctuation punctuation",children:"}"})]}),(0,t.jsx)(n.span,{className:"token string",children:" to "}),(0,t.jsxs)(n.span,{className:"token interpolation",children:[(0,t.jsx)(n.span,{className:"token interpolation-punctuation punctuation",children:"${"}),"fileDef",(0,t.jsx)(n.span,{className:"token interpolation-punctuation punctuation",children:"}"})]}),(0,t.jsx)(n.span,{className:"token template-punctuation string",children:"`"})]}),(0,t.jsx)(n.span,{className:"token punctuation",children:")"}),(0,t.jsx)(n.span,{className:"token punctuation",children:";"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:[(0,t.jsx)(n.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,t.jsx)(n.span,{className:"code-line",children:"\n"}),(0,t.jsxs)(n.span,{className:"code-line",children:[(0,t.jsx)(n.span,{className:"token function",children:"glob"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),(0,t.jsx)(n.span,{className:"token function",children:"resolve"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),"__dirname",(0,t.jsx)(n.span,{className:"token punctuation",children:","})," ",(0,t.jsx)(n.span,{className:"token string",children:'"../src/**/*.js"'}),(0,t.jsx)(n.span,{className:"token punctuation",children:")"}),(0,t.jsx)(n.span,{className:"token punctuation",children:","})," ",(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),(0,t.jsxs)(n.span,{className:"token parameter",children:["err",(0,t.jsx)(n.span,{className:"token punctuation",children:","})," files"]}),(0,t.jsx)(n.span,{className:"token punctuation",children:")"})," ",(0,t.jsx)(n.span,{className:"token arrow operator",children:"=>"})," ",(0,t.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["  files",(0,t.jsx)(n.span,{className:"token punctuation",children:"."}),(0,t.jsx)(n.span,{className:"token method function property-access",children:"forEach"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),(0,t.jsx)(n.span,{className:"token parameter",children:"file"})," ",(0,t.jsx)(n.span,{className:"token arrow operator",children:"=>"})," ",(0,t.jsx)(n.span,{className:"token function",children:"copyFile"}),(0,t.jsx)(n.span,{className:"token punctuation",children:"("}),"file",(0,t.jsx)(n.span,{className:"token punctuation",children:")"}),(0,t.jsx)(n.span,{className:"token punctuation",children:")"}),(0,t.jsx)(n.span,{className:"token punctuation",children:";"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:[(0,t.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,t.jsx)(n.span,{className:"token punctuation",children:")"}),(0,t.jsx)(n.span,{className:"token punctuation",children:";"}),"\n"]})]})}),"\n",(0,t.jsx)(n.p,{children:"Then, you can execute this script at the end of your build pipeline, as follows:"}),"\n",(0,t.jsx)(n.pre,{className:"language-json",children:(0,t.jsxs)(n.code,{className:"language-json code-highlight",children:[(0,t.jsxs)(n.span,{className:"code-line",children:[(0,t.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["  ",(0,t.jsx)(n.span,{className:"token property",children:'"scripts"'}),(0,t.jsx)(n.span,{className:"token operator",children:":"})," ",(0,t.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["    ",(0,t.jsx)(n.span,{className:"token property",children:'"build"'}),(0,t.jsx)(n.span,{className:"token operator",children:":"})," ",(0,t.jsx)(n.span,{className:"token string",children:'"npx babel ./src -d ./dest && npm run defs"'}),(0,t.jsx)(n.span,{className:"token punctuation",children:","}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["    ",(0,t.jsx)(n.span,{className:"token property",children:'"watch"'}),(0,t.jsx)(n.span,{className:"token operator",children:":"})," ",(0,t.jsx)(n.span,{className:"token string",children:'"npx babel ./src -d ./dest --watch"'}),(0,t.jsx)(n.span,{className:"token punctuation",children:","}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["    ",(0,t.jsx)(n.span,{className:"token property",children:'"defs"'}),(0,t.jsx)(n.span,{className:"token operator",children:":"})," ",(0,t.jsx)(n.span,{className:"token string",children:'"npx babel-node ./bin/defs.js"'}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["  ",(0,t.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,t.jsx)(n.span,{className:"token punctuation",children:","}),"\n"]}),(0,t.jsx)(n.span,{className:"code-line",children:"\n"}),(0,t.jsxs)(n.span,{className:"code-line",children:["  ",(0,t.jsx)(n.span,{className:"token property",children:'"devDependencies"'}),(0,t.jsx)(n.span,{className:"token operator",children:":"})," ",(0,t.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["    ",(0,t.jsx)(n.span,{className:"token property",children:'"babel-cli"'}),(0,t.jsx)(n.span,{className:"token operator",children:":"})," ",(0,t.jsx)(n.span,{className:"token string",children:'"^6.26.0"'}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:["  ",(0,t.jsx)(n.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,t.jsxs)(n.span,{className:"code-line",children:[(0,t.jsx)(n.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,t.jsx)(s,{}),"\n",(0,t.jsxs)(n.h3,{id:"adding-definitions-to-flow-typed",children:[(0,t.jsx)(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#adding-definitions-to-flow-typed",children:(0,t.jsx)(n.span,{className:"icon icon-link"})}),"Adding definitions to flow-typed"]}),"\n",(0,t.jsxs)(n.p,{children:["Flow supports library definitions which allow you to describe the interface of a module or library separate from the implementation of that module/library. You can add your definitions by ",(0,t.jsx)(n.a,{href:"https://flow-typed.github.io/flow-typed/#/?id=how-do-i-contribute-library-definitions",rel:"nofollow noopener noreferrer",target:"_blank",children:"contributing library definitions"})," which reside in the ",(0,t.jsx)(n.code,{children:"flow-typed"})," repository. It will allow people who use your library to fetch definitions by using the following command:"]}),"\n",(0,t.jsx)(n.pre,{className:"language-bash",children:(0,t.jsx)(n.code,{className:"language-bash code-highlight",children:(0,t.jsxs)(n.span,{className:"code-line",children:["$ flow-typed ",(0,t.jsx)(n.span,{className:"token function",children:"install"})," library@x.x.x\n"]})})}),"\n",(0,t.jsxs)(n.h2,{id:"conclusion",children:[(0,t.jsx)(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#conclusion",children:(0,t.jsx)(n.span,{className:"icon icon-link"})}),"Conclusion"]}),"\n",(0,t.jsx)(n.p,{children:"It is important to export Flow definitions so Flow can give errors if someone accidentally misuses your library. Additionally, it integrates well with most IDEs, as it gives developers a better experience by providing documentation, auto-complete and errors in real-time."})]})}var l=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,o.a)(),e.components);return n?(0,t.jsx)(n,Object.assign({},e,{children:(0,t.jsx)(i,e)})):i(e)};var c=s(4361),r=s(8029),d=s(8875),p=s(180),h=s(5551),m=s(9213),u=s(3120),x=s(6026),j=s(2349),N=s(7123);function k(e){let{data:n,pageContext:s,children:a}=e;const i=s.data,{frontmatter:l,tableOfContents:j}=i,{slug:k,timeToRead:f}=i.fields,{title:g,language:w,authors:y,datePublished:b,datePublishedMeta:v,dateUpdated:_,dateUpdatedMeta:F}=l,I=`${n.site.siteMetadata.siteUrl}/thumbnails/${(0,c.H)(k)}.png`;return(0,t.jsx)(h.A,{children:(0,t.jsx)(d.V,{children:(0,t.jsxs)("article",{className:"post",itemScope:!0,itemType:"http://schema.org/Article",lang:w,children:[(0,t.jsx)("meta",{itemProp:"image",content:I}),(0,t.jsx)("meta",{itemProp:"dateModified",content:F}),(0,t.jsx)("meta",{itemProp:"wordCount",content:`${f.words}`}),(0,t.jsxs)("header",{className:"post__header",children:[(0,t.jsx)("h1",{itemProp:"headline",children:g}),(0,t.jsxs)("p",{className:"post__header--metadata",children:[(0,t.jsx)(u.X,{data:y})," on ",(0,t.jsx)("time",{dateTime:v,itemProp:"datePublished",title:`Last modified on ${_}`,className:"post__header--date",children:b})," • ",(0,t.jsx)(x.t,{value:f.minutes})]})]}),(0,t.jsxs)("div",{className:"post__wrapper",children:[j.items?(0,t.jsx)("div",{className:"post__toc",children:(0,t.jsx)(N.o,{data:j})}):null,(0,t.jsxs)("div",{className:"post__content",children:[(0,t.jsx)("div",{itemProp:"articleBody",children:(0,t.jsx)(o.Z,{components:{Alert:r.b,Newsletter:m.m},children:a})}),(0,t.jsx)(p.$,{lang:w})]})]})]})})})}function f(e){return a.createElement(k,e,a.createElement(l,e))}function g(e){let{data:n,pageContext:s}=e;const a=s.data,o=a.fields.slug,{excerpt:i}=a,{title:l,description:r}=a.frontmatter,d=n.site.siteMetadata.siteUrl,p=`${d}/thumbnails/${(0,c.H)(o)}.png`;return(0,t.jsx)(j.H,{url:`${d}${o}`,title:l,image:p,description:r||i,children:(0,t.jsx)("html",{className:"smooth-scroll"})})}}}]);
//# sourceMappingURL=component---src-templates-blog-post-tsx-content-file-path-content-blog-2018-05-13-exporting-flow-definitions-to-npm-index-md-4e0531653fc216a8c79d.js.map