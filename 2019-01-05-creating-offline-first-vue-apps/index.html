<!DOCTYPE html><html lang="en" dir="ltr" vocab="http://schema.org" itemType="http://schema.org/WebPage" itemscope=""><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, shrink-to-fit=no, minimal-ui"/><style data-href="/styles.0a233f904beccf991928.css" id="gatsby-global-css">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}*,:after,:before{box-sizing:inherit;outline:none}body,html{-webkit-overflow-scrolling:touch;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-ms-overflow-style:scrollbar;min-width:320px;height:100%;width:100%;box-sizing:border-box}a,code,h1,h2,h3,h4,h5,h6,html,li,p{text-rendering:optimizeLegibility;font-smoothing:subpixel-antialiased;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:subpixel-antialiased}h1,h2,h3,h4,h5,h6{font-feature-settings:"dlig","liga","lnum","kern"}body{background-color:var(--background-100);font-family:var(--fn-main);font-size:var(--fs-0)}:root{--fn-main:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;--fn-mono:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;--fn-serif:"pt serif",Georgia,Cambria,times new roman,Times,serif;--fs-0:16px;--cs-xxs:2px;--cs-xs:4px;--cs-sm:8px;--cs-md:12px;--cs-lg:16px;--cs-xl:24px;--cs-xxl:32px;--ls-xxs:16px;--ls-xs:24px;--ls-sm:32px;--ls-md:48px;--ls-lg:64px;--ls-xl:96px;--ls-xxl:160px}body.dark{--background-100:#101011;--background-300:#1b1b1d;--background-500:#343434;--primary-100:hsl(266 48% 15%);--primary-300:hsl(266 48% 35%);--primary-500:hsl(266 48% 50%);--primary-700:hsl(266 48% 75%);--primary-900:hsl(266 48% 96%);--highlight-keyword:var(--primary-500);--text-primary:#d2d2d2;--text-secondary:#9f9f9f}body.dark,body.light{--highlight-comment:green;--highlight-literal:#a31515}body.light{--background-100:#fff;--background-300:#f8f8f8;--background-500:#e0e0e0;--primary-100:hsl(30 98% 96%);--primary-300:hsl(30 98% 75%);--primary-500:hsl(30 98% 50%);--primary-700:hsl(30 98% 35%);--primary-900:hsl(30 98% 15%);--highlight-keyword:#fd8103;--text-primary:#000;--text-secondary:#404040}a{color:var(--primary-500);text-decoration:none;border:solid transparent;border-width:0 0 3px}a:focus{border-color:var(--primary-500)}.visually-hidden:not(:focus){position:absolute!important;width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}.list{margin:0;padding:0;list-style:none}.repositories{display:grid;column-gap:var(--ls-xxs);row-gap:1em;padding:0 0 var(--ls-xl) 0}@media screen and (min-width:700px){.repositories{grid-template-columns:repeat(2,1fr)}}@media screen and (min-width:1050px){.repositories{grid-template-columns:repeat(3,1fr)}}.post__content{counter-reset:h2}.post__content h2{counter-reset:h3}.post__content h3{counter-reset:h4}.post__content h4{counter-reset:h5}.post__content h5{counter-reset:h6}.post__content h2:before{counter-increment:h2;content:counter(h2) ". "}.post__content h3:before{counter-increment:h3;content:counter(h2) "." counter(h3) ". "}.post__content h4:before{counter-increment:h4;content:counter(h2) "." counter(h3) "." counter(h4) ". "}.post__content h5:before{counter-increment:h5;content:counter(h2) "." counter(h3) "." counter(h4) "." counter(h5) ". "}.post__content h6:before{counter-increment:h6;content:counter(h2) "." counter(h3) "." counter(h4) "." counter(h5) "." counter(h6) ". "}.post h1,.post h2,.post h3,.post h4,.post h5,.post h6{font-feature-settings:"dlig","liga","lnum","kern";font-family:var(--fn-main);font-style:normal;font-weight:700;letter-spacing:-.02em}.post__content,.post__content blockquote,.post__content blockquote p,.post__content ol li,.post__content p,.post__content ul li{font-family:var(--fn-serif);font-style:normal;font-weight:400;font-size:1.25rem;line-height:1.5}.post__content code,.post__content pre{text-rendering:optimizeLegibility;font-smoothing:subpixel-antialiased;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:subpixel-antialiased}.post__content{overflow-wrap:break-word;word-break:break-word;word-wrap:break-word}.post__header{margin:var(--ls-xl) 0;text-align:center;color:var(--text-primary)}.post__content{max-width:850px;margin-left:auto;margin-right:auto;color:var(--text-primary)}.post__content details summary{font-family:var(--fn-main);font-weight:500}.post__content a{border:underline currentcolor;border-width:0 0 1px;letter-spacing:-.005em;color:inherit}.post__content a:focus,.post__content a:hover{color:var(--primary-500);border:solid var(--primary-500);border-width:0 0 2px}.post__content abbr{border-bottom:1px dashed var(--text-secondary);text-decoration:none;cursor:help}.post__content h2,.post__content h3{margin-top:var(--ls-md)}.post__content h4{margin-top:var(--ls-sm)}.post__content h1+p,.post__content h2+p,.post__content h3+p,.post__content h4+p,.post__content h5+p,.post__content h6+p{margin-top:var(--ls-xxs)}.post__content b,.post__content strong{font-weight:700}.post__content em{font-feature-settings:"liga" on,"salt" on}.post__content dl,.post__content ol,.post__content p,.post__content ul{font-feature-settings:"kern","onum","liga"}.post__content p{letter-spacing:.01rem;margin-top:var(--ls-xxs);margin-bottom:0}.post__content p img{max-width:100%;height:auto;margin:var(--ls-sm) auto var(--ls-xxs)}.post__content li>code,.post__content p>code{padding:.15rem .25rem;margin:0 .1rem}.post__content ol,.post__content ul{margin:var(--ls-sm) 0;padding:0;counter-reset:post}.post__content ol li,.post__content ul li{margin-left:var(--ls-sm);margin-bottom:var(--ls-xxs);letter-spacing:-.005em}.post__content ol ol,.post__content ol ul,.post__content ul ol,.post__content ul ul{margin:var(--ls-xxs) 0 0}.post__content blockquote,.post__content blockquote p{font-style:italic;letter-spacing:-.01em;border-left:3px solid var(--text-secondary);padding-left:20px;padding-bottom:2px;margin-left:-23px;margin-top:29px;color:var(--text-secondary)}.post__content code,.post__content pre{font-family:var(--fn-mono);font-size:18px;font-weight:400;font-style:normal;line-height:1.5;font-feature-settings:"liga" 0;background-color:var(--background-300);color:var(--text-secondary);border-radius:5px}.post__content pre{-webkit-overflow-scrolling:touch;margin:var(--ls-md) 0;padding:var(--ls-xs);letter-spacing:0;overflow:auto}.post__content code{letter-spacing:-.005em}.post__content code .keyword{color:var(--highlight-keyword)}.post__content code .comment{color:var(--highlight-comment)}.post__content code .string{color:var(--highlight-literal)}.post__content code .gatsby-highlight-code-line{background-color:var(--background-500);display:block;margin-right:calc(var(--ls-xs)*-1);margin-left:calc(var(--ls-xs)*-1);padding-right:1em;padding-left:1.25em;border-left:.25em solid var(--primary-500)}.post__content figure{margin:0}.post__content hr{display:block;margin:var(--ls-xl) 0;padding:0;border:0;height:0;text-align:center}.post__content hr:before{font-family:var(--fn-serif);font-weight:400;font-style:italic;font-size:28px;letter-spacing:.6em;content:"...";display:inline-block;margin-left:.6em;color:var(--text-secondary);position:relative;top:-30px}.post__content mark{background-color:var(--background-100)}.post h1{font-size:3rem}@media screen and (min-width:800px){.post h1{font-size:2rem}}.post h2{font-size:1.9rem;line-height:1.1}.post h3{font-size:1.8rem;line-height:1.15}.post h4{font-size:1.6rem;line-height:1.2}.toc{margin:2rem 0}.toc ul{list-style-type:none;counter-reset:toc}.toc li{display:table;counter-increment:toc}.toc li:before{display:table-cell;padding:0 .5rem 0 0;content:counters(toc,".") ". "}.toc li,.toc li p,.toc li ul,.toc li ul>li{margin-top:var(--cs-xxs)!important;margin-bottom:var(--cs-xxs)!important}.toc li ul,.toc li ul>li{margin:0!important}.skip{position:absolute;top:21px;left:1rem;font-family:var(--fn-main);font-weight:700;font-size:1.25rem;background-color:var(--primary-500);color:var(--text-primary);z-index:5}.header{position:fixed;top:0;left:0;width:100%;height:var(--ls-lg);background-color:rgba(var(--background-100),.85);box-shadow:0 0 10px -2px var(--background-100);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);z-index:4}.header__content{display:flex;align-items:center;margin:0 auto;padding:0 var(--cs-lg);height:100%;max-width:1250px;list-style:none}.header__item{font-family:var(--fn-main);font-weight:500;padding:0 0 0 var(--cs-xl)}.header__item a{color:var(--text-primary)}.header__item--logo{flex:1 1;padding:0;font-weight:700;font-size:1.25rem}:root{--toggle-light:hsl(30 98% 50%);--toggle-light-hover:hsl(30 98% 35%);--toggle-dark:hsl(266 48% 50%);--toggle-dark-hover:hsl(266 48% 35%)}.react-toggle{display:inline-block;position:relative;cursor:pointer;background-color:transparent;border:0;padding:0;touch-action:pan-x;-webkit-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent}.react-toggle-screenreader-only{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.react-toggle-track{width:40px;height:24px;padding:0;border-radius:30px;background-color:var(--toggle-light);transition:all .2s ease}.react-toggle:hover .react-toggle-track{background-color:var(--toggle-light-hover)}.react-toggle--checked .react-toggle-track{background-color:var(--toggle-dark)}.react-toggle--checked:hover .react-toggle-track{background-color:var(--toggle-dark-hover)}.react-toggle-thumb{position:absolute;top:1px;left:1px;width:22px;height:22px;border:1px solid var(--toggle-light);border-radius:50%;background-color:#fafafa;box-sizing:border-box;transition:all .5s cubic-bezier(.23,1,.32,1) 0ms}.react-toggle--checked .react-toggle-thumb{left:17px;border-color:var(--toggle-dark)}.react-toggle--focus .react-toggle-thumb{box-shadow:0 0 0 1px hsla(0,0%,100%,.25)}.react-toggle:active .react-toggle-thumb{box-shadow:0 0 0 5px hsla(0,0%,100%,.25)}.footer{position:relative;margin:0 auto;padding:var(--ls-lg) var(--ls-xxs);max-width:1250px;width:100%}.footer__menu{padding:0;margin:0 0 var(--cs-xl)}.footer__item{display:inline-block;margin:0 var(--cs-md);font-family:var(--fn-mono);font-size:16px;line-height:32px}@media screen and (min-width:700px){.footer__item{margin:0 var(--cs-lg)}}.footer__item--contact{float:right}.footer__item a{color:var(--text-primary)}.footer__item-text{display:none}@media screen and (min-width:700px){.footer__item-text{display:initial}}.footer__item-icon{position:relative;width:22px}.footer__item-icon--linkedin{top:-1px;width:20px}.footer__item-icon--youtube{top:2px;width:26px}@media screen and (min-width:700px){.footer__item-icon{display:none}}.footer__contact-text{display:none}@media screen and (min-width:375px){.footer__contact-text{display:initial}}.footer__contact-icon{position:relative;top:4px;width:22px}@media screen and (min-width:375px){.footer__contact-icon{display:none}}.footer__source{margin:var(--cs-xl) var(--cs-lg) 0;color:var(--text-primary)}.post-excerpt__wrapper{max-width:600px;margin:var(--ls-lg) 0}.post-excerpt__title{margin:var(--cs-lg) 0}.post-excerpt__title a{color:var(--text-primary)}.post-excerpt__content{margin:0;font-family:var(--fn-serif);line-height:1.5;letter-spacing:-.003em;color:var(--text-secondary)}.post-excerpt__date{margin:0;font-family:var(--fn-mono);font-size:14px;color:var(--text-secondary)}.hero{width:100%;height:50vh;min-height:500px}.hero__wrapper{display:flex;align-items:center;justify-content:center;width:100%;height:100%;background-color:var(--background-300);background:linear-gradient(180deg,var(--background-100),var(--background-300) 40%) fixed}.hero__title{margin:0 0 var(--cs-lg);font-size:65px;line-height:65px;letter-spacing:-.003em;color:var(--text-primary)}@media screen and (min-width:800px){.hero__title{font-size:83px;line-height:83px}}.hero__subtitle{margin:0 0 0 var(--cs-xs);font-size:18px;letter-spacing:-.005em;color:var(--text-primary)}@media screen and (min-width:800px){.hero__subtitle{font-size:16px}}.hero__subtitle span{display:none}@media screen and (min-width:800px){.hero__subtitle span{display:initial}}.content{position:relative;margin:0 auto;padding:var(--ls-lg) var(--ls-xxs);max-width:1250px;width:100%}.dark .repository__link{background-color:var(--background-300)}.repository__link{position:relative;display:flex;flex-direction:column;height:100%;padding:var(--cs-lg) var(--cs-md) var(--cs-md);transition-property:transform,box-shadow;transition-duration:.2s;transition-timing-function:ease-in-out;border-radius:6px;border:1px solid var(--background-500);box-shadow:0 1px 1px rgba(0,0,0,.08);outline:0}.repository__link:focus,.repository__link:hover{transform:scale(1.025)}.repository__link:hover{box-shadow:0 5px 15px -5px rgba(0,0,0,.1)}.repository__link:focus{border-color:var(--primary-300);box-shadow:0 0 0 5px var(--primary-100)}.repository__meta{display:flex;position:absolute;top:1rem;right:1rem;margin:0;padding:0;list-style:none;font-size:.85rem;background-image:linear-gradient(90deg,rgba(var(--background-100),1e-7),var(--background-100) 15%)}.repository__meta,.repository__name{font-family:var(--fn-mono);color:var(--text-primary)}.repository__name{margin:0 var(--cs-sm);font-size:.9rem;font-weight:500}.repository__description{flex:1 1;margin:var(--cs-md) var(--cs-sm) var(--cs-lg);font-size:.9rem;line-height:1.25rem;color:var(--text-primary)}.index-module--keyword--23WFF{display:inline-block;padding:var(--cs-xs) var(--cs-sm);margin:0 var(--cs-xxs);font-size:.8rem;color:var(--primary-700);background-color:var(--primary-100);border-radius:3px}.heading__wrapper{display:block;width:100%;height:auto;text-align:center}.heading__text{max-width:460px;margin-left:auto;margin-right:auto;color:var(--text-primary)}.heading__text--h2{margin-top:0;margin-bottom:var(--ls-xxs);font-size:2.5rem;font-weight:700}.heading__text--h3{margin-bottom:var(--ls-lg);font-size:1rem;font-weight:400;line-height:1.5}</style><meta name="generator" content="Gatsby 3.0.1"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{all:inherit;bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">Creating offline-first Progressive Web Applications in Vue.js • Bartosz Łaniewski</title><meta data-react-helmet="true" name="description" content="With JavaScript increasingly gaining popularity, Progressive Web Apps (PWAs) might replace native mobile &amp; desktops apps in the future. In this post, we will…"/><meta data-react-helmet="true" property="og:title" content="Creating offline-first Progressive Web Applications in Vue.js"/><meta data-react-helmet="true" property="og:description" content="With JavaScript increasingly gaining popularity, Progressive Web Apps (PWAs) might replace native mobile &amp; desktops apps in the future. In this post, we will…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Creating offline-first Progressive Web Applications in Vue.js"/><meta data-react-helmet="true" name="twitter:description" content="With JavaScript increasingly gaining popularity, Progressive Web Apps (PWAs) might replace native mobile &amp; desktops apps in the future. In this post, we will…"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-0ebc66f19ad09731229e.js"/><link as="script" rel="preload" href="/framework-6e16d2e965452ee6998a.js"/><link as="script" rel="preload" href="/app-4596f7dc087fcc733ad4.js"/><link as="script" rel="preload" href="/commons-d64158afc0e841bcd560.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-tsx-b339f30a9bb3b70e7b42.js"/><link as="fetch" rel="preload" href="/page-data/2019-01-05-creating-offline-first-vue-apps/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2176249065.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3000541721.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body class="light"><script>
                window.__theme = "light";
                window.__onThemeChange = function onThemeChange() {};

                function setTheme(newTheme) {
                  window.__theme = newTheme;
                  preferredTheme = newTheme;
                  document.body.className = newTheme;
                  window.__onThemeChange(newTheme);
                }

                window.__setPreferredTheme = function setPreferredTheme(newTheme) {
                  setTheme(newTheme);
                  localStorage.setItem('theme', newTheme);
                }

                var preferredTheme = localStorage.getItem('theme');
                var prefersDarkQuery = window.matchMedia('(prefers-color-scheme: dark)');

                prefersDarkQuery.addListener(function (event) {
                  window.__setPreferredTheme(event.matches ? 'dark' : 'light')
                });

                setTheme(preferredTheme || (prefersDarkQuery.matches ? 'dark' : 'light'));
            </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><a class="skip visually-hidden" href="#content">Skip to main content</a><nav class="header" itemType="http://schema.org/SiteNavigationElement" itemscope=""><ul class="header__content"><li class="header__item header__item--logo"><a rel="index" title="Go to main page" href="/">Łanek</a></li><li class="header__item"><a class="" href="/posts/">Devblog</a></li><li class="header__item"><a target="_blank" rel="author noopener noreferrer" href="https://drive.google.com/file/d/1Zh3NaFogEkufa25H7qxqj0QdqHPzyfZX/view" title="Get my résumé from Google Drive">Résumé</a></li><li class="header__item"><div class="react-toggle"><div class="react-toggle-track"><div class="react-toggle-track-check"></div><div class="react-toggle-track-x"></div></div><div class="react-toggle-thumb"></div><input type="checkbox" aria-label="Toggle theme" class="react-toggle-screenreader-only"/></div></li></ul></nav><main id="content" class="content" itemProp="mainContentOfPage"><article class="post" itemscope="" itemType="http://schema.org/Article"><header class="post__header"><h1 itemProp="headline">Creating offline-first Progressive Web Applications in Vue.js</h1><p>January 04, 2019</p></header><section itemProp="articleBody" class="post__content"><p>With JavaScript increasingly gaining popularity, Progressive Web Apps (<em>PWAs</em>) might replace native mobile &#x26; desktops apps in the future. In this post, we will learn how to develop and test offline-first, Vue-based Progressive Web Applications and why it is worth-it.</p>
<h2>Introduction to Progressive Web Apps (PWAs)</h2>
<p>Progressive Web Apps can be installed on most devices like native apps. They are meant to be <strong>reliable</strong> (work on each platform, even offline), <strong>fast</strong> and provide a <strong>native-like</strong> user experience. These apps combine the best of web and native solutions:</p>
<ul>
<li>They are <strong>rapid to develop</strong>, <strong>cross-platform</strong> and <strong>responsive</strong> by nature. JavaScript provides a lot of frameworks (such as <a href="https://vuejs.org/">Vue</a>, <a href="https://reactjs.org/">React</a>) and dedicated front-end component libraries to boost productivity (Bootstrap, Material UI). You write your code once and deploy you application on every platform;</li>
<li><strong>Fast load</strong>, <strong>fast response</strong>. Progressive web apps are comparable to native solutions in terms of efficiency. With <em>service workers</em>, cache and several optimizations made in engines running JavaScript, Progressive Web Applications’ loading and response times are very low.</li>
</ul>
<p>It is important to notice that if you are planning on making your application a PWA, you don’t have to rewrite all the logic. For example, your application should work offline, but it doesn’t mean that you must set-up a background queue or store your data in a persistent storage – a offline message (e.g. “<em>You’re offline, check your network status.</em>”) is enough.</p>
<h3>Browser support</h3>
<p>Progressive Web Apps are compatible with every mobile device which support one of the following browsers:</p>
<ul>
<li><strong>Google Chrome</strong> (since v40+);</li>
<li><strong>Firefox</strong> (since v44+);</li>
<li><strong>Safari</strong> (since v11.1+);</li>
<li><strong>Edge</strong> (since v17+);</li>
</ul>
<p>Additionally, Google Chrome recently added support for Progressive Web Apps on desktop platforms, such as:</p>
<ul>
<li><strong>Chrome OS</strong> (since Chrome 67+);</li>
<li><strong>Linux</strong> (since Chrome 70+);</li>
<li><strong>Windows</strong> (since Chrome 70+);</li>
<li><strong>macOS</strong> (since Chrome 72+);</li>
</ul>
<h2>Getting started</h2>
<p>In this article, we will be using <a href="https://cli.vuejs.org/">Vue-CLI</a> to create a brand-new Vue project. You can follow the instructions on <a href="https://cli.vuejs.org/guide/creating-a-project.html#vue-create">their website</a>. I encourage you to manually select the following features:</p>
<ol>
<li><strong>Babel</strong> (used in this tutorial);</li>
<li><strong>TypeScript</strong> (used in this tutorial);</li>
<li><strong>Progressive Web App</strong> (PWA) support (required in this tutorial);</li>
</ol>
<h3>Setting up a service worker</h3>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API">Service workers</a> (not to be confused with <a href="https://developer.mozilla.org/en-US/docs/Web/API/Worklet"><em>Worklets</em></a> or raw <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers"><em>Workers</em></a>) represents a proxy between the browser and the network – they allow you to intercept requests made by your application and handle each one separately enabling offline access, browser-level caching and more.</p>
<p>Like Workers, service workers are executed on a different thread and communicate with the main one – your web application, via an API: since Workers are on a different thread, they don’t have direct access to any of your web app internals. Workers generally offer more functionality than the standard browser API and Service Workers, i.e. to send push notifications, create periodic background tasks, hook into OS internals (<a href="https://developers.google.com/web/updates/2016/09/navigator-share">Share Target API</a>, …).</p>
<p>In order to use Workers, your website must be served over HTTPS. Even if service Workers are not compatible with some web browsers, you can safely add them in your application – it will not break the experience for any user (<em>progressive enhancement</em>).</p>
<p><a href="https://github.com/vuejs/vue-cli/tree/dev/packages/@vue/cli-plugin-pwa"><code class="language-text">@vue/cli-plugin-pwa</code></a> should take care of creating a Service Worker. The generated Service Worker will cache all builded resources. If you want to create a service worker manually, you can modify this behaviour in the <code class="language-text">vue.config.js</code> file by adding the following lines:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">module</span><span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
 pwa<span class="token operator">:</span> <span class="token punctuation">{</span>
   workboxPluginMode<span class="token operator">:</span> <span class="token string">"InjectManifest"</span><span class="token punctuation">,</span>
   workboxOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
     swSrc<span class="token operator">:</span> <span class="token string">"public/service-worker.js"</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>It is important that the path in <code class="language-text">swSrc</code> option matches the path specified in <code class="language-text">registerServiceWorker.ts</code> file, otherwise you Service Worker will not be registered. You can then use <a href="https://developers.google.com/web/tools/workbox/guides/get-started">Workbox</a> to define custom rules for request interceptors. Here’s an example:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// public/service-worker.js</span>
workbox<span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span> debug<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
workbox<span class="token punctuation">.</span>precaching<span class="token punctuation">.</span><span class="token function">precacheAndRoute</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Cache images:</span>
workbox<span class="token punctuation">.</span>routing<span class="token punctuation">.</span><span class="token function">registerRoute</span><span class="token punctuation">(</span>
 <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(?:png|gif|jpg|jpeg|svg)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
 workbox<span class="token punctuation">.</span>strategies<span class="token punctuation">.</span><span class="token function">staleWhileRevalidate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   cacheName<span class="token operator">:</span> <span class="token string">"images"</span><span class="token punctuation">,</span>
   plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token keyword">new</span> <span class="token class-name">workbox<span class="token punctuation">.</span>expiration<span class="token punctuation">.</span>Plugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
       maxEntries<span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
       maxAgeSeconds<span class="token operator">:</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token comment">// 30 days</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Cache Google fonts:</span>
workbox<span class="token punctuation">.</span>routing<span class="token punctuation">.</span><span class="token function">registerRoute</span><span class="token punctuation">(</span>
 <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">"https://fonts.(?:googleapis|gstatic).com/(.*)"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 workbox<span class="token punctuation">.</span>strategies<span class="token punctuation">.</span><span class="token function">cacheFirst</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   cacheName<span class="token operator">:</span> <span class="token string">"googleapis"</span><span class="token punctuation">,</span>
   plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token keyword">new</span> <span class="token class-name">workbox<span class="token punctuation">.</span>expiration<span class="token punctuation">.</span>Plugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
       maxEntries<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
       maxAgeSeconds<span class="token operator">:</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token comment">// 30 days</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3>Prompting the user to install</h3>
<p>Installing a Progressive Web Application works the same way on both mobile and desktop devices. The website must meet a few requirements before it can be prompted to install:</p>
<ol>
<li>Meet a user engagement heuristic;</li>
<li>Include a web app manifest file;</li>
<li>Have an icon to represent the app on the device;</li>
<li>Have a registered service worker to make the app work offline;</li>
<li>The web app must be served over HTTPS and not being already installed;</li>
</ol>
<p>If those criterias are met, web browser will emit a <code class="language-text">beforeinstallprompt</code> event which you can use to notify the user that your app can be installed. The most common way is by adding a button on the website. It is considered best practice to don’t show a full page banner or distracting notifications. Let’s add some markup for our <code class="language-text">InstallBanner</code> component:</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>banner<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deferredPrompt<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Do you want to install Foo App?<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>promptInstall<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Opt for!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></code></pre></div>
<p>Instead of dealing with adding and removing event listeners for <code class="language-text">beforeinstallpromptevent</code> manually, we can use <a href="https://git.milosolutions.com/blaniewski/vue-pwa-install"><code class="language-text">vue-pwa-install</code></a> plugin which I wrote for this article. It will emit a <code class="language-text">canInstall</code> in the root event bus – what you need to do is listen for this particular event in one of your components. First, let’s install the <code class="language-text">vue-pwa-install</code> plugin with the following command:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> --save vue-pwa-install</code></pre></div>
<p>Then, register this installed plugin in your app entry point:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> VueInstall <span class="token keyword">from</span> <span class="token string">"vue-pwa-install"</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueInstall<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Once registered, we can listen for <code class="language-text">canInstall</code> event in any component and handle the event to show the install prompt. Let’s add the following code in our <code class="language-text">InstallBanner</code> component:</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
 <span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Vue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-property-decorator"</span><span class="token punctuation">;</span>
 <span class="token keyword">import</span> <span class="token punctuation">{</span> BeforeInstallPromptEvent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-pwa-install"</span><span class="token punctuation">;</span>

 @<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">InstallBanner</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
   deferredPrompt<span class="token operator">:</span> BeforeInstallPromptEvent <span class="token operator">|</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

   <span class="token function">promptInstall</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// Show the prompt:</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>deferredPrompt<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">// Wait for the user to respond to the prompt:</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>deferredPrompt<span class="token punctuation">.</span>userChoice<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">choiceResult</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>choiceResult<span class="token punctuation">.</span>outcome <span class="token operator">===</span> <span class="token string">"accepted"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">// User accepted the install prompt</span>
       <span class="token punctuation">}</span>

       <span class="token keyword">this</span><span class="token punctuation">.</span>deferredPrompt <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">"canInstall"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> BeforeInstallPromptEvent</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
       <span class="token comment">// Prevent Chrome >=67 from automatically showing the prompt:</span>
       event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">// Stash the event so it can be triggered later:</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>deferredPrompt <span class="token operator">=</span> event<span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div>
<p>And that’s all. The banner should be displayed on the website once the 5 requirements listed above are met, and when the user click on <em>Opt for</em> button, he will be asked by the browser if he wants to install the app on his local machine.</p>
<h3>Prompting the user to update</h3>
<p>In <code class="language-text">registerServiceWorker.ts</code> file, you should have a updated handler. This function will be executed each time a new version of your website is available – in order to get the updated version, the user should simply reload the page. It is considered very bad practice to force a page reload, therefore it is advised to create a small banner which will pop-up and inform the user about the update. We can start by creating a banner markup in our <code class="language-text">index.html</code> file, as follows:</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>update-banner<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>banner<span class="token punctuation">"</span></span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token style language-css"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>There's a new version of Foo App.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>update-button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Reload<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<p>Next, we need to show this banner when a new update comes in, and add necessary event handlers for the “Reload” button. This can be achieved directly in <code class="language-text">updated</code> function:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token function">updated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token comment">// New content is available</span>
 <span class="token keyword">const</span> updateBanner <span class="token operator">=</span> <span class="token operator">&lt;</span>HTMLElement<span class="token operator">></span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"update-banner"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">const</span> updateButton <span class="token operator">=</span> <span class="token operator">&lt;</span>HTMLElement<span class="token operator">></span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"update-button"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 updateBanner<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>
 updateButton<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
   location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Note that you could create a Vue component instead of a pure HTML-based banner, but then you should store <code class="language-text">updateAvailable</code> state in your App’ store (e.g. Vuex) and it will require some more work.</p>
<p>If possible, configure your production environment to serve <code class="language-text">service-worker.js</code> with HTTP caching disabled. Otherwise if you visit your web app, and then revisit again before <code class="language-text">service-worker.js</code> has expired from cache, you’ll continue to get the update banner showing.</p>
<h3>Handling offline-first forms</h3>
<p>There are 2 ways of handling offline forms: the first one is by intercepting the request when user is offline and sending it again when there’s a internet connection. There are a few problems that you must take care of:</p>
<ol>
<li><strong>Concurrency:</strong> what if the data on remote database has changed when user was offline? Overwriting it might be an unwanted behaviour.</li>
<li><strong>False positives:</strong> if the user is connected to internet, it doesn’t necessary mean that he can send requests yet (i.e. paid hotspots).</li>
<li><strong>Error handling:</strong> when the request failed, how should we inform the user that the request he tried to made 3 days ago failed?</li>
<li><strong>Application architecture:</strong> this kind of offline-first form handling often requires a more complex architecture.</li>
</ol>
<p>The easier approach is to save the form state in local storage and inform the user that he will be able to submit the form once he’ll be online again. This solution can be implemented in a few line for each already existing form.</p>
<p>Let’s start with creating a local store in <code class="language-text">store/local.ts</code>. We will use <a href="https://github.com/localForage/localForage"><code class="language-text">LocalForage</code></a> library which wraps IndexedDB, WebSQL, or localStorage using a simple but powerful API. It will allow us to store data in the most suitable local storage available on user’s device:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> LocalForage <span class="token keyword">from</span> <span class="token string">"localforage"</span><span class="token punctuation">;</span>

<span class="token comment">// This must be called before any other calls to localForage are made:</span>
LocalForage<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"foo-app"</span><span class="token punctuation">,</span>
  storeName<span class="token operator">:</span> <span class="token string">"foo-app-store"</span><span class="token punctuation">,</span>
  version<span class="token operator">:</span> <span class="token number">1.0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> LocalForage<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> formStore <span class="token operator">=</span> LocalForage<span class="token punctuation">.</span><span class="token function">createInstance</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"form"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Then, we can modify any form to use the local <code class="language-text">formStore</code> when needed, as follows:</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">@submit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onSubmit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form.author<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Your name…<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form.message<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Message…<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Send<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
 <span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Vue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-property-decorator"</span><span class="token punctuation">;</span>
 <span class="token keyword">import</span> <span class="token punctuation">{</span> formStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/store/local"</span><span class="token punctuation">;</span>

 type Nullable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
 type Optional<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>

 <span class="token keyword">interface</span> <span class="token class-name">FormData</span> <span class="token punctuation">{</span>
   author<span class="token operator">?</span><span class="token operator">:</span> Nullable<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">;</span>
   message<span class="token operator">?</span><span class="token operator">:</span> Nullable<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>

 @<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">SomeForm</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
   form<span class="token operator">:</span> FormData <span class="token operator">=</span> <span class="token punctuation">{</span>
     author<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
     message<span class="token operator">:</span> <span class="token keyword">null</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>

   <span class="token function">resetForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span>author <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

     <span class="token comment">// Reset local storage:</span>
     formStore<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"some-form-author"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     formStore<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"some-form-message"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token function">storeData</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">:</span> FormData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     formStore<span class="token punctuation">.</span>setItem<span class="token operator">&lt;</span>Optional<span class="token operator">&lt;</span>Nullable<span class="token operator">&lt;</span>string<span class="token operator">>>></span><span class="token punctuation">(</span><span class="token string">"some-form-author"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>author<span class="token punctuation">)</span><span class="token punctuation">;</span>
     formStore<span class="token punctuation">.</span>setItem<span class="token operator">&lt;</span>Optional<span class="token operator">&lt;</span>Nullable<span class="token operator">&lt;</span>string<span class="token operator">>>></span><span class="token punctuation">(</span><span class="token string">"some-form-message"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token function">sendData</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">:</span> FormData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">// Make a request here…</span>
   <span class="token punctuation">}</span>

   <span class="token function">onSubmit</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> Event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     event<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">// Normalize &amp; validate form data:</span>
     <span class="token keyword">const</span> form<span class="token operator">:</span> FormData <span class="token operator">=</span> <span class="token punctuation">{</span>
       author<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span>author<span class="token punctuation">,</span>
       message<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span>message
     <span class="token punctuation">}</span><span class="token punctuation">;</span>

     <span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>onLine<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sendData</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">storeData</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     formStore<span class="token punctuation">.</span>getItem<span class="token operator">&lt;</span>Nullable<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token punctuation">(</span><span class="token string">"some-form-author"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span>author <span class="token operator">=</span> value<span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     formStore<span class="token punctuation">.</span>getItem<span class="token operator">&lt;</span>Nullable<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token punctuation">(</span><span class="token string">"some-form-message"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>form<span class="token punctuation">.</span>message <span class="token operator">=</span> value<span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div>
<h3>Showing offline information</h3>
<p>If your application is not fully offline-first (e.g. you don’t save the requests in a queue like in the previous section), it is important to notify the users about their connection status. You can use <code class="language-text">navigator.onLine</code> property and <code class="language-text">ononline</code>, <code class="language-text">onoffline</code> events or let the <a href="https://github.com/filrak/vue-offline"><code class="language-text">vue-offline</code></a> plugin take care of all of this.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> --save vue-offline</code></pre></div>
<p>It will add <code class="language-text">isOnline</code>, <code class="language-text">isOffline</code> data properties and <code class="language-text">online</code>, <code class="language-text">offline</code> events via a global mixin. We need to register their plugin in <code class="language-text">main.ts</code>, as follows:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> VueOffline <span class="token keyword">from</span> <span class="token string">"vue-offline"</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueOffline<span class="token punctuation">,</span> <span class="token punctuation">{</span> storage<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Then we can safely listen for the online and offline events in our <code class="language-text">App.vue</code>:</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>offline<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!isOnline<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>You are offline.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span>

   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
 <span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Vue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-property-decorator"</span><span class="token punctuation">;</span>

 @<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
   isOnline <span class="token operator">=</span> navigator<span class="token punctuation">.</span>onLine<span class="token punctuation">;</span>

   <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">"online"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"User is now online"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>isOnline <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">"offline"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"User is now offline"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>isOnline <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div>
<h3>Making Vuex state persistent</h3>
<p>If you want some parts of your data persistent, available in offline mode, you’ll need a persistent store, which replicated and retrieve the Vuex store to/from a local storage. In this article, I’ll focus on a Vuex plugin named <a href="https://github.com/championswimmer/vuex-persist"><code class="language-text">vuex-persist</code></a>. You can download it with the following command:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> --save vuex-persist</code></pre></div>
<p>Since we are already using LocalForage, we’ll use it to store the persistent data. Let’s create a wrapper over the <code class="language-text">vuex-persist</code> plugin:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// src/store/plugins/persistent.ts</span>
<span class="token keyword">import</span> LocalForage <span class="token keyword">from</span> <span class="token string">"localforage"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> VuexPersistence <span class="token keyword">from</span> <span class="token string">"vuex-persist"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">createPersistedState</span><span class="token punctuation">(</span>options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> store <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> VuexForage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VuexPersistence</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token operator">...</span>options<span class="token punctuation">,</span>

      storage<span class="token operator">:</span> LocalForage<span class="token punctuation">,</span>
      asyncStorage<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

      <span class="token comment">// Used to trigger `storageReady` event as soon as the state is loaded</span>
      <span class="token comment">// from LocalForage:</span>
      <span class="token function-variable function">restoreState</span><span class="token operator">:</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> storage<span class="token punctuation">)</span> <span class="token operator">=></span>
        <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span>resolve <span class="token operator">=></span> <span class="token punctuation">{</span>
          storage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>data <span class="token operator">=></span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

            store<span class="token punctuation">.</span>_vm<span class="token punctuation">.</span>$root<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">"storageReady"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> VuexForage<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>We must register this plugin in our Vuex Store:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// src/store/index.ts</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">"vuex"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> createLogger <span class="token keyword">from</span> <span class="token string">"vuex/dist/logger"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> createPersistedState <span class="token keyword">from</span> <span class="token string">"./plugins/persistent"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">"./modules/foo"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> bar <span class="token keyword">from</span> <span class="token string">"./modules/bar"</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Disable logs &amp; strict mode in production:</span>
<span class="token keyword">const</span> debug <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">"production"</span><span class="token punctuation">;</span>

<span class="token comment">// Plugins for both `development` &amp; `production` modes:</span>
<span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token function">createPersistedState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    strictMode<span class="token operator">:</span> debug<span class="token punctuation">,</span>
    <span class="token comment">// Specify here which modules should be persistent:</span>
    modules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"foo"</span><span class="token punctuation">,</span> <span class="token string">"bar"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Plugins for `development` mode:</span>
<span class="token keyword">const</span> devPlugins <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token comment">// Integrates with Vue Devtools:</span>
  <span class="token function">createLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Plugins for `production` mode:</span>
<span class="token keyword">const</span> prodPlugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex</span><span class="token punctuation">.</span><span class="token function">Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  strict<span class="token operator">:</span> debug<span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> debug
    <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token operator">...</span>plugins<span class="token punctuation">,</span> <span class="token operator">...</span>devPlugins<span class="token punctuation">]</span>
    <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>plugins<span class="token punctuation">,</span> <span class="token operator">...</span>prodPlugins<span class="token punctuation">]</span><span class="token punctuation">,</span>

  modules<span class="token operator">:</span> <span class="token punctuation">{</span>
    foo<span class="token punctuation">,</span>
    bar
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>And voila! Data from foo and bar modules will be persistent, automatically stored and retrieved in/from the local storage. The last this we need to do is wait till the store is rehydrated before rendering the main app component, but since we are emitting a <code class="language-text">storageReady</code> event in our <code class="language-text">vuex-persist</code> wrapper, this should be pretty easy:</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition-group</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fade<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Loader</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app-loader<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!isStateReady<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Content</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app-content<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isStateReady<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition-group</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> Loader <span class="token keyword">from</span> <span class="token string">"./components/Loader.vue"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Content <span class="token keyword">from</span> <span class="token string">"./components/Content.vue"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"App"</span><span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    Loader<span class="token punctuation">,</span>
    Content
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    isStateReady<span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// This event is fired by "persistent" Vuex plugin when state is loaded from</span>
    <span class="token comment">// local storage (i.e. IndexedDB):</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>_vm<span class="token punctuation">.</span>$root<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">"storageReady"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>isStateReady <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div>
<h2>Testing offline-first applications</h2>
<p>Google Chrome’s DevTools offer a lot of functions test the PWA features of your web application. However, some of them require HTTPS certificates, even on localhost. Let’s see how to properly set-up a testing environment to test our Vue.js application.</p>
<h3>Creating a development environment with HTTPS</h3>
<p>In order to test service workers and other features locally, we will need to generate our own, self-signed certificate and add it to our OS’s trust store. This process is described on <a href="https://letsencrypt.org/docs/certificates-for-localhost/">letsencrypt page</a> – it requires only the following command to generate certificates:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">openssl req -x509 -out localhost.crt -keyout localhost.key <span class="token punctuation">\</span>
  -newkey rsa:2048 -nodes -sha256 <span class="token punctuation">\</span>
  -subj <span class="token string">'/CN=localhost'</span> -extensions EXT -config <span class="token operator">&lt;</span><span class="token punctuation">(</span> <span class="token punctuation">\</span>
   <span class="token builtin class-name">printf</span> <span class="token string">"[dn]<span class="token entity" title="\n">\n</span>CN=localhost<span class="token entity" title="\n">\n</span>[req]<span class="token entity" title="\n">\n</span>distinguished_name = dn<span class="token entity" title="\n">\n</span>[EXT]<span class="token entity" title="\n">\n</span>subjectAltName=DNS:localhost<span class="token entity" title="\n">\n</span>keyUsage=digitalSignature<span class="token entity" title="\n">\n</span>extendedKeyUsage=serverAuth"</span><span class="token punctuation">)</span></code></pre></div>
<p>Once <code class="language-text">localhost.crt</code> installed and trusted on our machine, we can modify <code class="language-text">vue.config.js</code> to use the generated certificates, as follows:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">"fs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">"production"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span>devServer <span class="token operator">=</span> <span class="token punctuation">{</span>
    https<span class="token operator">:</span> <span class="token punctuation">{</span>
      key<span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">"localhost.key"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      cert<span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">"localhost.crt"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">module</span><span class="token punctuation">.</span>exports <span class="token operator">=</span> config<span class="token punctuation">;</span></code></pre></div>
<p>We can add some utility scripts in our <code class="language-text">package.json</code> to facilitate our work:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"serve:prod"</span><span class="token operator">:</span> <span class="token string">"vue-cli-service build --mode=production --watch &amp; node ./serve.js"</span><span class="token punctuation">,</span>
    <span class="token property">"serve:dev"</span><span class="token operator">:</span> <span class="token string">"vue-cli-service serve --mode=development"</span><span class="token punctuation">,</span>
    <span class="token property">"serve"</span><span class="token operator">:</span> <span class="token string">"vue-cli-service serve"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Now, we can run:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> run serve:prod</code></pre></div>
<p>…and test our PWA here.</p>
<h3>Testing the application in offline mode</h3>
<p>You can test your Progressive Web Applications directly in the browser, without the need to manually disable network connections.</p>
<ol>
<li>Go to <strong>Network</strong> panel;</li>
<li>Click <strong>Offline</strong> in the bar.</li>
</ol>
<h3>Testing the “add to home screen” experience</h3>
<ol>
<li>Go to the <strong>Application</strong> panel;</li>
<li>Go to the <strong>Manifest</strong> tab;</li>
<li>Click <strong>Add to home screen</strong>.</li>
</ol>
<h3>Making a general Progressive Web App audit</h3>
<ol>
<li>Go to the <strong>Audits</strong> panel (Lighthouse);</li>
<li>Select <strong>Progressive Web App</strong>;</li>
<li>Click <strong>Run audits</strong>.</li>
</ol>
<h2>Conclusion</h2>
<p>In this article, we learned how to create a great base for offline-first, PWAs using Vue.js, web manifest and other standards. There’s a lot more to consider to make a great native-like feeling and keep your user engaged. Here are some points to consider:</p>
<ul>
<li>Keyboard shortcuts;</li>
<li>Notification &#x26; icon badges;</li>
</ul></section></article></main><footer class="footer" itemType="http://schema.org/WPFooter" itemscope=""><nav typeof="http://schema.org/ContactPoint" itemscope=""><ul class="footer__menu"><li class="footer__item"><a target="_blank" itemProp="url" rel="noopener noreferrer" href="https://github.com/Bartozzz"><svg class="footer__item-icon footer__item-icon--github" role="img" viewBox="0 0 24 24"><title>GitHub icon</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="footer__item-text">GitHub</span></a></li><li class="footer__item"><a target="_blank" itemProp="url" rel="noopener noreferrer" href="https://dribbble.com/bartozzz"><svg class="footer__item-icon footer__item-icon--dribbble" role="img" viewBox="0 0 24 24"><title>Dribbble icon</title><path d="M12 24C5.385 24 0 18.615 0 12S5.385 0 12 0s12 5.385 12 12-5.385 12-12 12zm10.12-10.358c-.35-.11-3.17-.953-6.384-.438 1.34 3.684 1.887 6.684 1.992 7.308 2.3-1.555 3.936-4.02 4.395-6.87zm-6.115 7.808c-.153-.9-.75-4.032-2.19-7.77l-.066.02c-5.79 2.015-7.86 6.025-8.04 6.4 1.73 1.358 3.92 2.166 6.29 2.166 1.42 0 2.77-.29 4-.814zm-11.62-2.58c.232-.4 3.045-5.055 8.332-6.765.135-.045.27-.084.405-.12-.26-.585-.54-1.167-.832-1.74C7.17 11.775 2.206 11.71 1.756 11.7l-.004.312c0 2.633.998 5.037 2.634 6.855zm-2.42-8.955c.46.008 4.683.026 9.477-1.248-1.698-3.018-3.53-5.558-3.8-5.928-2.868 1.35-5.01 3.99-5.676 7.17zM9.6 2.052c.282.38 2.145 2.914 3.822 6 3.645-1.365 5.19-3.44 5.373-3.702-1.81-1.61-4.19-2.586-6.795-2.586-.825 0-1.63.1-2.4.285zm10.335 3.483c-.218.29-1.935 2.493-5.724 4.04.24.49.47.985.68 1.486.08.18.15.36.22.53 3.41-.43 6.8.26 7.14.33-.02-2.42-.88-4.64-2.31-6.38z"></path></svg><span class="footer__item-text">Dribbble</span></a></li><li class="footer__item"><a target="_blank" itemProp="url" rel="noopener noreferrer" href="https://linkedin.com/in/bartozzz"><svg class="footer__item-icon footer__item-icon--linkedin" role="img" viewBox="0 0 24 24"><title>LinkedIn icon</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg><span class="footer__item-text">LinkedIn</span></a></li><li class="footer__item"><a target="_blank" itemProp="url" rel="noopener noreferrer" href="https://youtube.com/channel/UCIC1vaSJwSJ2sqKWC3wTTmQ"><svg class="footer__item-icon footer__item-icon--youtube" role="img" viewBox="0 0 24 24"><title>YouTube icon</title><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"></path></svg><span class="footer__item-text">YouTube</span></a></li><li class="footer__item footer__item--contact"><a target="_blank" itemProp="email" rel="noopener noreferrer" href="mailto:hi@laniewski.me"><svg class="footer__contact-icon" role="img" viewBox="0 0 24 24"><title>Cotnact me</title><path d="M15.61 12c0 1.99-1.62 3.61-3.61 3.61-1.99 0-3.61-1.62-3.61-3.61 0-1.99 1.62-3.61 3.61-3.61 1.99 0 3.61 1.62 3.61 3.61M12 0C5.383 0 0 5.383 0 12s5.383 12 12 12c2.424 0 4.761-.722 6.76-2.087l.034-.024-1.617-1.879-.027.017A9.494 9.494 0 0 1 12 21.54c-5.26 0-9.54-4.28-9.54-9.54 0-5.26 4.28-9.54 9.54-9.54 5.26 0 9.54 4.28 9.54 9.54a9.63 9.63 0 0 1-.225 2.05c-.301 1.239-1.169 1.618-1.82 1.568-.654-.053-1.42-.52-1.426-1.661V12A6.076 6.076 0 0 0 12 5.93 6.076 6.076 0 0 0 5.93 12 6.076 6.076 0 0 0 12 18.07a6.02 6.02 0 0 0 4.3-1.792 3.9 3.9 0 0 0 3.32 1.805c.874 0 1.74-.292 2.437-.821.719-.547 1.256-1.336 1.553-2.285.047-.154.135-.504.135-.507l.002-.013c.175-.76.253-1.52.253-2.457 0-6.617-5.383-12-12-12"></path></svg><span class="footer__contact-text">Get in touch</span></a></li></ul></nav><p class="footer__source" itemProp="description">Hand-coded using Gatsby, TypeScript and more.<!-- --> <a target="_blank" itemProp="url" rel="noopener noreferrer" href="https://github.com/Bartozzz/bartozzz.github.io">See the source.</a></p></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2019-01-05-creating-offline-first-vue-apps/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-f6b5fa3802b0dba31afd.js"],"app":["/app-4596f7dc087fcc733ad4.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-17ff38c864b82ed2840d.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-ad37ad7babf6c16ae3e5.js"],"component---src-pages-posts-tsx":["/component---src-pages-posts-tsx-025f76052328ecbb7bad.js"],"component---src-templates-blog-post-tsx":["/component---src-templates-blog-post-tsx-b339f30a9bb3b70e7b42.js"]};/*]]>*/</script><script src="/polyfill-f6b5fa3802b0dba31afd.js" nomodule=""></script><script src="/component---src-templates-blog-post-tsx-b339f30a9bb3b70e7b42.js" async=""></script><script src="/commons-d64158afc0e841bcd560.js" async=""></script><script src="/app-4596f7dc087fcc733ad4.js" async=""></script><script src="/framework-6e16d2e965452ee6998a.js" async=""></script><script src="/webpack-runtime-0ebc66f19ad09731229e.js" async=""></script></body></html>