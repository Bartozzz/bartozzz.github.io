"use strict";(self.webpackChunklaniewski_me=self.webpackChunklaniewski_me||[]).push([[232],{3441:function(n,s,e){var a=e(5893),c=e(1151);function l(n){const s=Object.assign({p:"p",a:"a",h2:"h2",svg:"svg",path:"path",ul:"ul",li:"li",h3:"h3",h4:"h4",pre:"pre",code:"code",span:"span",blockquote:"blockquote",ol:"ol",h5:"h5",strong:"strong"},(0,c.a)(),n.components),{Newsletter:e,Alert:l}=s;return l||t("Alert",!0),e||t("Newsletter",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.a,{href:"https://tiltcopters.laniewski.me",children:"Tilt Copters"})," is a relatively simple game created with ",(0,a.jsx)(s.a,{href:"https://pixijs.com/",rel:"nofollow noopener noreferrer",target:"_blank",children:"PixiJS"})," and Expo. This is a project I’ve started to learn more about porting web libraries to React Native but also about game architecture and monetization."]}),"\n",(0,a.jsxs)(s.h2,{id:"introduction",children:["Introduction",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Introduction"',href:"#introduction",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsx)(s.p,{children:"Tilt Copters is a casual endless game. The user picks the character he wishes to pilot and can explore various maps. The character can be moved by tilting the device. The user has to avoid obstacles and the higher he gets, the faster and more challenging the game becomes."}),"\n",(0,a.jsx)(s.p,{children:"Technology stack:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://expo.dev/",rel:"nofollow noopener noreferrer",target:"_blank",children:"Expo"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://www.typescriptlang.org/",rel:"nofollow noopener noreferrer",target:"_blank",children:"TypeScript"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://reactnavigation.org/",rel:"nofollow noopener noreferrer",target:"_blank",children:"React Navigation"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://styled-components.com/",rel:"nofollow noopener noreferrer",target:"_blank",children:"Styled Components"})}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"https://pixijs.com/",rel:"nofollow noopener noreferrer",target:"_blank",children:"PixiJS"})," with ",(0,a.jsx)(s.a,{href:"https://github.com/Bartozzz/expo-pixi",rel:"nofollow noopener noreferrer",target:"_blank",children:"my port"})," of the library"]}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://redux-toolkit.js.org/",rel:"nofollow noopener noreferrer",target:"_blank",children:"Redux Toolkit"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://github.com/pmndrs/zustand",rel:"nofollow noopener noreferrer",target:"_blank",children:"Zustand"})}),"\n"]}),"\n",(0,a.jsxs)(s.h2,{id:"development",children:["Development",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Development"',href:"#development",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsx)(s.p,{children:"I am well aware that React Native might not be ready for game development just yet. I picked it out of curiosity – I wanted to see where the limits of this technology are."}),"\n",(0,a.jsx)(s.p,{children:"Nevertheless, React Native has its benefits. The main advantage over native solutions is that it’s easy to make cross-platform applications for mobile, desktop, and web while still having the option to interop native code when necessary. It has an established ecosystem, community and is backed by a lot of big companies (industry momentum)."}),"\n",(0,a.jsxs)(s.h3,{id:"architecture",children:["Architecture",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Architecture"',href:"#architecture",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsx)(s.p,{children:"Let’s start by analyzing the elements and features that we have in the game. We have:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"a character and a map defined by a background, pipes, and coins;"}),"\n",(0,a.jsx)(s.li,{children:"a controller system that hooks to the device accelerometer;"}),"\n",(0,a.jsx)(s.li,{children:"a collision system that handles pipes and coin collisions;"}),"\n"]}),"\n",(0,a.jsxs)(s.h4,{id:"game-manager",children:["Game Manager",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Game Manager"',href:"#game-manager",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.p,{children:["The Game Manager is a ",(0,a.jsx)(s.a,{href:"https://refactoring.guru/design-patterns/mediator",rel:"nofollow noopener noreferrer",target:"_blank",children:"mediator"})," and serves as an aggregator for the Game Objects."]}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"class"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"GameManager"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"constructor"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," context ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," EngineConfiguration",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"application ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"new"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:(0,a.jsx)(s.span,{className:"token constant",children:"PIXI"})}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"Application"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," context ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token comment",children:"// Updates:"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"ticker",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"add"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token keyword",children:"if"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"store",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"state ",(0,a.jsx)(s.span,{className:"token operator",children:"==="})," ",(0,a.jsx)(s.span,{className:"token string",children:'"isPlaying"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token comment",children:"// Updates:"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"background",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"update"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"speed",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"character",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"update"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"speed",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"pipes",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"forEach"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"pipe",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," pipe",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"update"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"speed",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"coins",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"forEach"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"coin",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," coin",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"update"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"speed",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token comment",children:"// Collision check:"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"obstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"check"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token comment",children:"// Speed increase:"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"speed ",(0,a.jsx)(s.span,{className:"token operator",children:"+="})," configuration",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"game",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"acceleration",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token comment",children:"// Controls:"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"controlManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"subscribe"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ControlManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token constant",children:"MOVE"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"data",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"number"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"character",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"move"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"data",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token comment",children:"// Collisions:"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"obstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"subscribe"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ObstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token constant",children:"PIPE_COLLISION"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"lose"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"obstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"subscribe"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ObstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token constant",children:"PIPE_PASSED"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"pipe",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      pipe",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"score"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"store",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"incrementScore"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"obstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"subscribe"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ObstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token constant",children:"COIN_COLLISION"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"coin",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      coin",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"score"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"store",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"incrementCoins"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"initialize"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"gameConfig",(0,a.jsx)(s.span,{className:"token operator",children:":"})," GameConfiguration",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token comment",children:"// …"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"reset"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token comment",children:"// …"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"destroy"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token comment",children:"// …"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"prepare"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"store",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"setState"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"isIdle"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"application",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"start"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"play"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"store",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"setState"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"isPlaying"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"application",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"start"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"lose"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"store",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"setState"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"isGameOver"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"application",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"stop"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"})]})}),"\n",(0,a.jsxs)(s.h4,{id:"game-objects",children:["Game Objects",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Game Objects"',href:"#game-objects",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.p,{children:["The Game Objects describe elements in the game world (character, background, pipe, coin). All these elements are implementing the ",(0,a.jsx)(s.code,{children:"GameObject"})," interface:"]}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"interface"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"GameObject"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token function",children:"update"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"delta",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"number"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"void"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token function",children:"destroy"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"void"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token function",children:"getBoundingBoxes"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," BoundingBox",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,a.jsxs)(s.h3,{id:"navigation",children:["Navigation",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Navigation"',href:"#navigation",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.p,{children:["I used ",(0,a.jsx)(s.a,{href:"https://reactnavigation.org/docs/stack-navigator/",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"@react-navigation/stack"})})," to handle all in-game navigation. I created ",(0,a.jsx)(s.a,{href:"https://reactnavigation.org/docs/stack-navigator/#animations",rel:"nofollow noopener noreferrer",target:"_blank",children:"custom interpolators"})," to give the user an illusion that the entire game is one big canvas just sliding down or up based on the view that we want to show."]}),"\n",(0,a.jsx)(s.p,{children:"Below is the code that I used to customize the transition when navigating from the menu to the shop and vice-versa:"}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"function"})," ",(0,a.jsx)(s.span,{className:"token function",children:"forShopInterpolator"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  index",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  current",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  next",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  inverted",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  layouts",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," screen ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," StackCardInterpolationProps",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," StackCardInterpolatedStyle ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," isFirst ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," index ",(0,a.jsx)(s.span,{className:"token operator",children:"==="})," ",(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," progress ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token function",children:"add"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    current",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"progress",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"interpolate"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      inputRange",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      outputRange",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      extrapolate",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"clamp"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"    next\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token operator",children:"?"})," next",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"progress",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"interpolate"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["          inputRange",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["          outputRange",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["          extrapolate",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"clamp"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token number",children:"0"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," translateY ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token function",children:"multiply"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    progress",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"interpolate"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      inputRange",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"2"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      outputRange",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        screen",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"height",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        isFirst ",(0,a.jsx)(s.span,{className:"token operator",children:"?"})," ",(0,a.jsx)(s.span,{className:"token number",children:"0"})," ",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        isFirst ",(0,a.jsx)(s.span,{className:"token operator",children:"?"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"-"}),"screen",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"height ",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"    inverted\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    cardStyle",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      overflow",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"hidden"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      transform",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," translateY ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,a.jsx)(e,{}),"\n",(0,a.jsxs)(s.h3,{id:"responsiveness",children:["Responsiveness",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Responsiveness"',href:"#responsiveness",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.p,{children:["Unlike most game engines, ",(0,a.jsx)(s.code,{children:"pixi.js"})," does not handle multiple resolutions out of the box. You’ll have to manually stretch the game viewport to match the device screen size."]}),"\n",(0,a.jsx)(s.p,{children:"My approach is to use a single base resolution and then fit it into everything else. The one I picked is 375x812pt (iPhone X). Think of this setting as the “design size”, i.e. the size of the area that you work with when creating textures."}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," Dimensions ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"from"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"react-native"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," window ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," Dimensions",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"get"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"window"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," targetWidth ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token number",children:"375"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," targetHeight ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token number",children:"812"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," scale ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"window",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"width ",(0,a.jsx)(s.span,{className:"token operator",children:"*"})," window",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"scale",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"/"})," targetWidth",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," canvas ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  width",(0,a.jsx)(s.span,{className:"token operator",children:":"})," targetWidth",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  height",(0,a.jsx)(s.span,{className:"token operator",children:":"})," targetHeight",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  scale",(0,a.jsx)(s.span,{className:"token operator",children:":"})," scale",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]})]})}),"\n",(0,a.jsxs)(s.p,{children:["Then, I just had to set the ",(0,a.jsx)(s.a,{href:"https://pixijs.download/v4.8.9/docs/PIXI.Application.html#Application",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"PIXI.Application"})})," ",(0,a.jsx)(s.code,{children:"width"}),", ",(0,a.jsx)(s.code,{children:"height"})," and ",(0,a.jsx)(s.code,{children:"resolution"})," as follows:"]}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"class"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"GameManager"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"private"})," application",(0,a.jsx)(s.span,{className:"token operator",children:"!"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token constant",children:"PIXI"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"Application",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"constructor"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," context ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," EngineConfiguration",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"application ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"new"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:(0,a.jsx)(s.span,{className:"token constant",children:"PIXI"})}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"Application"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      context",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["      width",(0,a.jsx)(s.span,{className:"token operator",children:":"})," configuration",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"canvas",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"width",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["      height",(0,a.jsx)(s.span,{className:"token operator",children:":"})," configuration",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"canvas",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"height",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["      resolution",(0,a.jsx)(s.span,{className:"token operator",children:":"})," configuration",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"canvas",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"scale",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"resolution"})," will stretch the canvas to fit the whole screen while maintaining aspect ratios no matter the resolution. The scene is rendered and then scaled to fit the screen."]}),"\n",(0,a.jsxs)(s.h3,{id:"state-management",children:["State management",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "State management"',href:"#state-management",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.p,{children:["I used ",(0,a.jsx)(s.a,{href:"https://github.com/pmndrs/zustand",rel:"nofollow noopener noreferrer",target:"_blank",children:"zustand"})," for game state management. It is a barebones state-management solution using simplified flux principles. It’s really easy to use and framework agnostic (no context providers are necessary), so I can use it in React (UI) and game managers (logic). My game store looks as follows:"]}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," create ",(0,a.jsx)(s.span,{className:"token keyword",children:"from"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"zustand"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," createVanilla ",(0,a.jsx)(s.span,{className:"token keyword",children:"from"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"zustand/vanilla"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," combine ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"from"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"zustand/middleware"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"interface"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"State"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  state",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"isIdle"'})," ",(0,a.jsx)(s.span,{className:"token operator",children:"|"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"isPlaying"'})," ",(0,a.jsx)(s.span,{className:"token operator",children:"|"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"isGameOver"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  score",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"number"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  coins",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"number"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," initialState",(0,a.jsx)(s.span,{className:"token operator",children:":"})," State ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  state",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"isIdle"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  score",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  coins",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," gameStore ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token function",children:"createVanilla"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token function",children:"combine"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"initialState",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"set",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token function-variable function",children:"reset"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token function",children:"set"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"initialState",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    setState",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"payload",(0,a.jsx)(s.span,{className:"token operator",children:":"})," State",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:'"state"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token function",children:"set"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"state",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," state",(0,a.jsx)(s.span,{className:"token operator",children:":"})," payload ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token function-variable function",children:"incrementScore"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"payload ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token function",children:"set"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"state",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," score",(0,a.jsx)(s.span,{className:"token operator",children:":"})," Math",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"max"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," state",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"score ",(0,a.jsx)(s.span,{className:"token operator",children:"+"})," payload",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token function-variable function",children:"incrementCoins"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"payload ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token function",children:"set"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"state",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," coins",(0,a.jsx)(s.span,{className:"token operator",children:":"})," Math",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"max"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," state",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"coins ",(0,a.jsx)(s.span,{className:"token operator",children:"+"})," payload",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," useGameStore ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token function",children:"create"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"gameStore",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]})]})}),"\n",(0,a.jsxs)(s.h4,{id:"usage-in-managers",children:["Usage in managers",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Usage in managers"',href:"#usage-in-managers",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"class"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"GameManager"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"private"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"get"})," ",(0,a.jsx)(s.span,{className:"token function",children:"store"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," gameStore",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"getState"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"constructor"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," context ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," EngineConfiguration",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"ticker",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"add"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["      ",(0,a.jsx)(s.span,{className:"token keyword",children:"if"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"store",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"state ",(0,a.jsx)(s.span,{className:"token operator",children:"==="})," ",(0,a.jsx)(s.span,{className:"token string",children:'"isPlaying"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token comment",children:"// Do the updates…"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"obstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"subscribe"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ObstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token constant",children:"PIPE_PASSED"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["      ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"store",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"incrementScore"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"obstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"subscribe"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ObstaclesManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token constant",children:"COIN_COLLISION"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["      ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"store",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"incrementCoins"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,a.jsxs)(s.h4,{id:"usage-in-react",children:["Usage in React",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Usage in React"',href:"#usage-in-react",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsx)(s.pre,{className:"language-tsx",children:(0,a.jsxs)(s.code,{className:"language-tsx code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"function"})," ",(0,a.jsx)(s.span,{className:"token function",children:"GameScore"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," score ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token function",children:"useGameStore"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"state",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token arrow operator",children:"=>"})," state",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token property-access",children:"score"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," ",(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"<"}),(0,a.jsx)(s.span,{className:"token class-name",children:"Text"})]})," ",(0,a.jsx)(s.span,{className:"token attr-name",children:"size"}),(0,a.jsxs)(s.span,{className:"token attr-value",children:[(0,a.jsx)(s.span,{className:"token punctuation attr-equals",children:"="}),(0,a.jsx)(s.span,{className:"token punctuation",children:'"'}),"lg",(0,a.jsx)(s.span,{className:"token punctuation",children:'"'})]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"score",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"</"}),(0,a.jsx)(s.span,{className:"token class-name",children:"Text"})]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,a.jsx)(l,{type:"info",children:(0,a.jsxs)(s.p,{children:["I used ",(0,a.jsx)(s.a,{href:"https://redux-toolkit.js.org/",rel:"nofollow noopener noreferrer",target:"_blank",children:"Redux Toolkit"})," for the user state (i.e. purchased items) and ",(0,a.jsx)(s.a,{href:"https://github.com/rt2zz/redux-persist",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"redux-persist"})})," for persistence. There are no particular reasons why I used Redux over Zustand or any other solution."]})}),"\n",(0,a.jsxs)(s.h2,{id:"challenges",children:["Challenges",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Challenges"',href:"#challenges",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.h3,{id:"expo-and-libraries",children:["Expo and libraries",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Expo and libraries"',href:"#expo-and-libraries",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.p,{children:["There’s an official library called ",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo-pixi",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"expo-pixi"})})," originally developed by Evan Bacon. This is the first search result when looking for ",(0,a.jsx)(s.a,{href:"https://pixijs.com/",rel:"nofollow noopener noreferrer",target:"_blank",children:"PixiJS"})," for Expo/React Native. I tried using this library but quickly abandoned it because of plenty of issues it has. Instead, I created my port with better compatibility. It can be found on ",(0,a.jsx)(s.a,{href:"https://github.com/Bartozzz/expo-pixi",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"Bartozzz/expo-pixi"})}),"."]}),"\n",(0,a.jsxs)(s.h4,{id:"issue-1-incompatible-with-expo-43-221",children:["Issue #1: incompatible with Expo 43 (",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo-pixi/issues/221",rel:"nofollow noopener noreferrer",target:"_blank",children:"#221"}),")",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Issue #1: incompatible with Expo 43 ()"',href:"#issue-1-incompatible-with-expo-43-221",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"expo-pixi"})," uses ",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo-asset-utils",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"expo-asset-utils"})})," which is incompatible with Expo SDK 43 and above. This is because Expo SDK 43 ",(0,a.jsxs)(s.a,{href:"https://blog.expo.dev/whats-new-in-expo-modules-infrastructure-7a7cdda81ebc",rel:"nofollow noopener noreferrer",target:"_blank",children:["deprecated the ",(0,a.jsx)(s.code,{children:"react-native-unimodules"})," package"]}),":"]}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsxs)(s.p,{children:["The ",(0,a.jsx)(s.code,{children:"react-native-unimodules"})," package is deprecated as of SDK 43, and the module system and autolinking implementation now live in the expo package instead."]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["The solution was to migrate from ",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo-asset-utils",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"expo-asset-utils"})})," to ",(0,a.jsx)(s.a,{href:"https://docs.expo.dev/versions/latest/sdk/asset/",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"expo-asset"})}),":"]}),"\n",(0,a.jsx)(s.pre,{className:"language-diff",children:(0,a.jsxs)(s.code,{className:"language-diff code-highlight",children:[(0,a.jsx)(s.span,{className:"code-line deleted",children:(0,a.jsxs)(s.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(s.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(s.span,{className:"token line",children:'import { resolveAsync } from "expo-asset-utils";\n'})]})}),(0,a.jsxs)(s.span,{className:"code-line inserted",children:[(0,a.jsx)(s.span,{className:"token deleted-sign deleted",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(s.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(s.span,{className:"token line",children:'import { Asset } from "expo-asset";\n'})]})]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token inserted-sign inserted",children:(0,a.jsx)(s.span,{className:"token line"})}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"const textureFromExpoAsync = async resource => {\n"}),(0,a.jsx)(s.span,{className:"code-line deleted",children:(0,a.jsxs)(s.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(s.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(s.span,{className:"token line",children:" const asset = await resolveAsync(resource);\n"})]})}),(0,a.jsxs)(s.span,{className:"code-line inserted",children:[(0,a.jsx)(s.span,{className:"token deleted-sign deleted",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(s.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(s.span,{className:"token line",children:" const asset = await Asset.fromModule(resource).downloadAsync();\n"})]})]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token inserted-sign inserted",children:(0,a.jsx)(s.span,{className:"token line"})}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:(0,a.jsxs)(s.span,{className:"token unchanged",children:[(0,a.jsx)(s.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(s.span,{className:"token line",children:" return PIXI.Texture.from(asset);\n"})]})}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token unchanged",children:(0,a.jsx)(s.span,{className:"token line"})}),"}\n"]})]})}),"\n",(0,a.jsxs)(s.h4,{id:"issue-2-invalid-dependencies-156",children:["Issue #2: invalid dependencies (",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo-pixi/issues/156",rel:"nofollow noopener noreferrer",target:"_blank",children:"#156"}),")",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Issue #2: invalid dependencies ()"',href:"#issue-2-invalid-dependencies-156",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"expo-pixi"})," does not have a locked-in version of ",(0,a.jsx)(s.code,{children:"pixi-filters"}),". It downloads the latest version which is incompatible with pixi-js V4;"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"expo-pixi"})," requires ",(0,a.jsx)(s.code,{children:"expo-gl"})," V4, which is incompatible with Expo SDK 40 and above;"]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"To fix those issues, I updated the dependencies as follows:"}),"\n",(0,a.jsx)(s.pre,{className:"language-diff",children:(0,a.jsxs)(s.code,{className:"language-diff code-highlight",children:[(0,a.jsx)(s.span,{className:"code-line",children:"{\n"}),(0,a.jsx)(s.span,{className:"code-line",children:(0,a.jsxs)(s.span,{className:"token unchanged",children:[(0,a.jsx)(s.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(s.span,{className:"token line",children:' "dependencies": {\n'})]})}),(0,a.jsxs)(s.span,{className:"code-line deleted",children:[(0,a.jsx)(s.span,{className:"token unchanged",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(s.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(s.span,{className:"token line",children:'   "pixi-filters": "*",\n'})]})]}),(0,a.jsxs)(s.span,{className:"code-line inserted",children:[(0,a.jsx)(s.span,{className:"token deleted-sign deleted",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(s.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(s.span,{className:"token line",children:'   "pixi-filters": "2.7.1",\n'})]})]}),(0,a.jsxs)(s.span,{className:"code-line deleted",children:[(0,a.jsx)(s.span,{className:"token inserted-sign inserted",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(s.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(s.span,{className:"token line",children:'   "pixi.js": "^4.7.0"\n'})]})]}),(0,a.jsxs)(s.span,{className:"code-line inserted",children:[(0,a.jsx)(s.span,{className:"token deleted-sign deleted",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(s.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(s.span,{className:"token line",children:'   "pixi.js": "latest-4.x"\n'})]})]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token inserted-sign inserted",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token unchanged",children:[(0,a.jsx)(s.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(s.span,{className:"token line",children:" },\n"})]})]}),(0,a.jsx)(s.span,{className:"code-line",children:(0,a.jsxs)(s.span,{className:"token unchanged",children:[(0,a.jsx)(s.span,{className:"token line"}),(0,a.jsx)(s.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(s.span,{className:"token line",children:' "peerDependencies": {\n'})]})}),(0,a.jsxs)(s.span,{className:"code-line deleted",children:[(0,a.jsx)(s.span,{className:"token unchanged",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(s.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(s.span,{className:"token line",children:'   "expo-gl": "~4.0.0"\n'})]})]}),(0,a.jsxs)(s.span,{className:"code-line inserted",children:[(0,a.jsx)(s.span,{className:"token deleted-sign deleted",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(s.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(s.span,{className:"token line",children:'   "expo-gl": "*"\n'})]})]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token inserted-sign inserted",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token unchanged",children:[(0,a.jsx)(s.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(s.span,{className:"token line",children:" }\n"})]})]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token unchanged",children:(0,a.jsx)(s.span,{className:"token line"})}),"}\n"]})]})}),"\n",(0,a.jsxs)(s.h4,{id:"issue-3-side-effects-and-library-overwriting-model",children:["Issue #3: side effects and library overwriting model",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Issue #3: side effects and library overwriting model"',href:"#issue-3-side-effects-and-library-overwriting-model",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"expo-pixi"})," overwrites ",(0,a.jsx)(s.code,{children:"pixi.js"})," methods in a quite ugly way. It mutates the PIXI instance:"]}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token constant",children:"PIXI"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token operator",children:"..."}),(0,a.jsx)(s.span,{className:"token constant",children:"PIXI"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  Application",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ExpoPIXIApplication",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  Texture",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token operator",children:"..."}),(0,a.jsx)(s.span,{className:"token constant",children:"PIXI"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"Texture",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token function-variable function",children:"from"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token operator",children:"..."}),"props",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,a.jsx)(s.span,{className:"token comment",children:"/* … */"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    fromExpoAsync",(0,a.jsx)(s.span,{className:"token operator",children:":"})," textureFromExpoAsync",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  Sprite",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token operator",children:"..."}),(0,a.jsx)(s.span,{className:"token constant",children:"PIXI"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"Sprite",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    fromExpoAsync",(0,a.jsx)(s.span,{className:"token operator",children:":"})," spriteFromExpoAsync",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token function-variable function",children:"from"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token operator",children:"..."}),"props",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," ",(0,a.jsx)(s.span,{className:"token comment",children:"/* … */"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,a.jsx)(s.p,{children:"There are several issues with this approach:"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsx)(s.li,{children:"This is causing side effects, as PIXI is declared in the global scope;"}),"\n",(0,a.jsx)(s.li,{children:"There was a mix of web-only and native-only code in a single file;"}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"To solve the first issue, my approach was to simply extend PIXI classes and re-export new PIXI objects:"}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"*"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"as"})," filters ",(0,a.jsx)(s.span,{className:"token keyword",children:"from"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"pixi-filters"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"*"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"as"})," PIXIInstance ",(0,a.jsx)(s.span,{className:"token keyword",children:"from"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"pixi.js"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"class"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"PIXIApplication"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"extends"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"PIXIInstance"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"Application ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token comment",children:"// …"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"class"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"PIXISprite"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"extends"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"PIXIInstance"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"Sprite ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"static"})," ",(0,a.jsx)(s.span,{className:"token function",children:"from"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"asset",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token comment",children:"// …"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"class"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"PIXITexture"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"extends"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"PIXIInstance"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"Texture ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"static"})," ",(0,a.jsx)(s.span,{className:"token function",children:"from"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"asset",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token comment",children:"// …"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," ",(0,a.jsx)(s.span,{className:"token constant",children:"PIXI"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token operator",children:"..."}),"PIXIInstance",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  filters",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token operator",children:"..."}),"PIXIInstance",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"filters",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token operator",children:"..."}),"filters",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  Application",(0,a.jsx)(s.span,{className:"token operator",children:":"})," PIXIApplication",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  Texture",(0,a.jsx)(s.span,{className:"token operator",children:":"})," PIXITexture",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  Sprite",(0,a.jsx)(s.span,{className:"token operator",children:":"})," PIXISprite",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]})]})}),"\n",(0,a.jsxs)(s.p,{children:["With this approach, I could safely remove the ",(0,a.jsx)(s.code,{children:"sideEffects"})," flag from ",(0,a.jsx)(s.code,{children:"package.json"}),":"]}),"\n",(0,a.jsx)(s.pre,{className:"language-diff",children:(0,a.jsxs)(s.code,{className:"language-diff code-highlight",children:[(0,a.jsx)(s.span,{className:"code-line",children:"{\n"}),(0,a.jsx)(s.span,{className:"code-line",children:(0,a.jsxs)(s.span,{className:"token unchanged",children:[(0,a.jsx)(s.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(s.span,{className:"token line",children:' "name": "expo-pixi",\n'})]})}),(0,a.jsxs)(s.span,{className:"code-line deleted",children:[(0,a.jsx)(s.span,{className:"token unchanged",children:(0,a.jsx)(s.span,{className:"token line"})}),(0,a.jsxs)(s.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(s.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(s.span,{className:"token line",children:' "sideEffects": true,\n'})]})]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token deleted-sign deleted",children:(0,a.jsx)(s.span,{className:"token line"})}),"}\n"]})]})}),"\n",(0,a.jsxs)(s.p,{children:["To solve the second issue, I simply moved the web code to ",(0,a.jsx)(s.code,{children:"pixi.ts"}),", and the native code to ",(0,a.jsx)(s.code,{children:"pixi.native.ts"}),". This is described in detail in ",(0,a.jsx)(s.a,{href:"https://reactnative.dev/docs/platform-specific-code#platform-specific-extensions",rel:"nofollow noopener noreferrer",target:"_blank",children:"React Native documentation: Platform-specific extensions"}),":"]}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsxs)(s.p,{children:["You can also use the ",(0,a.jsx)(s.code,{children:".native.js"})," extension when a module needs to be shared between NodeJS/Web and React Native but it has no Android/iOS differences. This is especially useful for projects that have common code shared among React Native and ReactJS."]}),"\n"]}),"\n",(0,a.jsxs)(s.h4,{id:"issue-4-assets-were-not-properly-bundled-on-production-build-66-92-103",children:["Issue #4: assets were not properly bundled on production build (",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo-pixi/issues/66",rel:"nofollow noopener noreferrer",target:"_blank",children:"#66"}),", ",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo-pixi/issues/92",rel:"nofollow noopener noreferrer",target:"_blank",children:"#92"}),", ",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo-pixi/issues/103",rel:"nofollow noopener noreferrer",target:"_blank",children:"#103"}),")",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Issue #4: assets were not properly bundled on production build (, , )"',href:"#issue-4-assets-were-not-properly-bundled-on-production-build-66-92-103",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsx)(l,{type:"warning",children:(0,a.jsx)(s.p,{children:"This was particularly hard to debug because it only happens on release (production) Android builds. This issue does not happen on development and Web/iOS platforms."})}),"\n",(0,a.jsxs)(s.p,{children:["There are issues with ",(0,a.jsx)(s.code,{children:"expo-gl"})," where ",(0,a.jsx)(s.code,{children:".jpg"})," and ",(0,a.jsx)(s.code,{children:".png"})," textures would not load in Android release variants. This is an issue (actually, several issues) with Expo and thus it was quite hard to fix it in the package itself. The fixes consist of several workarounds described below:"]}),"\n",(0,a.jsxs)(s.h5,{id:"invalid-file-scheme",children:["Invalid file scheme",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Invalid file scheme"',href:"#invalid-file-scheme",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsx)(s.p,{children:"When built as APK, the image asset resolves to something like:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"code-highlight",children:(0,a.jsx)(s.span,{className:"code-line",children:"file:/data/user/0/…/.expo-internal/some-hash.png\n"})})}),"\n",(0,a.jsxs)(s.p,{children:["The problem is that ",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo/blob/master/packages/expo-gl-cpp/cpp/EXGLImageUtils.cpp#L126",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"expo-gl#loadImage"})})," expects ",(0,a.jsx)(s.code,{children:"file://"})," scheme and not ",(0,a.jsx)(s.code,{children:"file:"})," (note the missing slashes). To solve this issue, we have to manually add the slashes to ",(0,a.jsx)(s.code,{children:"asset.localUri"}),"s, as follows:"]}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token comment",children:"// An asset uri might start with `file:` and not `file://`."}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token comment",children:"// `expo-gl` expects a texture asset to have the slashes. Enforce the slashes."}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"function"})," ",(0,a.jsx)(s.span,{className:"token function",children:"fixFileUri"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"uri",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"string"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token comment",children:"// https://github.com/expo/expo/blob/master/packages/expo-gl-cpp/cpp/EXGLImageUtils.cpp#L126"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," uri",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"startsWith"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"file:"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"&&"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"!"}),"uri",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"startsWith"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"file://"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token operator",children:"?"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"file://"'})," ",(0,a.jsx)(s.span,{className:"token operator",children:"+"})," uri",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"substring"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token number",children:"5"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token operator",children:":"})," uri",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"async"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"function"})," ",(0,a.jsx)(s.span,{className:"token function",children:"textureFromAssetAsync"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"resource",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"string"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"|"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"number"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," asset ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"await"})," Asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"fromModule"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"resource",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"downloadAsync"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"localUri ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token function",children:"fixFileUri"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"localUri",(0,a.jsx)(s.span,{className:"token operator",children:"!"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," PIXITexture",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"from"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"asset ",(0,a.jsx)(s.span,{className:"token keyword",children:"as"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"any"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,a.jsxs)(s.h5,{id:"invalid-path-for-images",children:["Invalid path for images",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Invalid path for images"',href:"#invalid-path-for-images",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.p,{children:["When you ",(0,a.jsx)(s.a,{href:"https://developer.android.com/guide/topics/resources/providing-resources",rel:"nofollow noopener noreferrer",target:"_blank",children:"bundle assets for your Android APK"}),", the assets go to the ",(0,a.jsx)(s.code,{children:"res"})," folder, but the subfolder they end up is dependent on the resource type. Bitmap files (",(0,a.jsx)(s.code,{children:".png"}),", ",(0,a.jsx)(s.code,{children:".jpg"}),", ",(0,a.jsx)(s.code,{children:".gif"}),", etc.) or XML files that are compiled into drawable resource subtypes go to ",(0,a.jsx)(s.code,{children:"res/drawables"})," directory."]}),"\n",(0,a.jsxs)(s.p,{children:["The issue is that in production, images are moved to the ",(0,a.jsx)(s.code,{children:"res/drawables"})," directory (as you would expect) but ",(0,a.jsx)(s.code,{children:"expo-file-system"})," ",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo/blob/main/packages/expo-file-system/android/src/main/java/expo/modules/filesystem/FileSystemModule.kt#L911=",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"FileSystem#downloadAsync"})})," only checks the ",(0,a.jsx)(s.code,{children:"raw"})," directory! Because of that, I was unable to load textures for ",(0,a.jsx)(s.code,{children:"expo-pixi"})," on Android."]}),"\n",(0,a.jsxs)(s.p,{children:["I don’t know any viable workaround for this issue. What worked for me was changing the image extensions to ",(0,a.jsx)(s.code,{children:".xjpg"})," and ",(0,a.jsx)(s.code,{children:".xpng"}),". I also had to update the ",(0,a.jsx)(s.code,{children:"textureFromAssetAsync"})," to change ",(0,a.jsx)(s.code,{children:"asset.type"})," to the correct extension and recalculate ",(0,a.jsx)(s.code,{children:"asset.width"})," and ",(0,a.jsx)(s.code,{children:"asset.height"})," as follows:"]}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token comment",children:"// https://github.com/expo/expo/blob/main/packages/expo-asset/src/ImageAssets.ts"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"function"})," ",(0,a.jsx)(s.span,{className:"token function",children:"getImageInfo"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"url",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"string"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"Promise"}),(0,a.jsx)(s.span,{className:"token operator",children:"<"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  width",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"number"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  height",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"number"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token operator",children:">"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"new"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:(0,a.jsx)(s.span,{className:"token builtin",children:"Promise"})}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"resolve",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," reject",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," img ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"new"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"Image"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    img",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"onerror ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," reject",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    img",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function-variable function",children:"onload"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token function",children:"resolve"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        width",(0,a.jsx)(s.span,{className:"token operator",children:":"})," img",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"width",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        height",(0,a.jsx)(s.span,{className:"token operator",children:":"})," img",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"height",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    img",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"src ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," url",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"async"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"function"})," ",(0,a.jsx)(s.span,{className:"token function",children:"textureFromAssetAsync"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"resource",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"string"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"|"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"number"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," asset ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"await"})," Asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"fromModule"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"resource",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"downloadAsync"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"localUri ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token function",children:"fixFileUri"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"localUri",(0,a.jsx)(s.span,{className:"token operator",children:"!"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["  asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"type ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"type",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"replace"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"x"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token string",children:'""'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"})," ",(0,a.jsx)(s.span,{className:"token comment",children:"// xpng => png, xjpg => jpg"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," width",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," height ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"await"})," ",(0,a.jsx)(s.span,{className:"token function",children:"getImageInfo"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"localUri",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["  asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"width ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," width",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line highlight-line",children:["  asset",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"height ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," height",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," PIXITexture",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"from"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"asset ",(0,a.jsx)(s.span,{className:"token keyword",children:"as"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"any"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n",(0,a.jsxs)(s.p,{children:["I also needed to update ",(0,a.jsx)(s.code,{children:"metro.config.js"})," to allow ",(0,a.jsx)(s.code,{children:".xjpg"})," and ",(0,a.jsx)(s.code,{children:".xpng"})," extensions:"]}),"\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," getDefaultConfig ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"require"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"@expo/metro-config"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," defaultConfig ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token function",children:"getDefaultConfig"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"__dirname",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token comment",children:"// Added .xjpg and .xpng extensions for sprites:"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["defaultConfig",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"resolver",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"assetExts",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"push"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"xjpg"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["defaultConfig",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"resolver",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"assetExts",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"push"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"xpng"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["module",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"exports ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," defaultConfig",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]})]})}),"\n",(0,a.jsxs)(s.h3,{id:"game-performance",children:["Game performance",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Game performance"',href:"#game-performance",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsx)(s.p,{children:"My aim I always to get at least a stable 60 FPS on all of the devices I have. Here are the results:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"https://www.gsmchoice.com/en/catalogue/apple/iphonex/",rel:"nofollow noopener noreferrer",target:"_blank",children:"iPhone X"}),": 60 FPS;"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"https://www.gsmchoice.com/en/catalogue/apple/iphone13pro/",rel:"nofollow noopener noreferrer",target:"_blank",children:"iPhone 13 Pro"}),": 60 FPS;"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"https://www.gsmchoice.com/en/catalogue/samsung/galaxys8/",rel:"nofollow noopener noreferrer",target:"_blank",children:"Samsung S8"}),": 50-60 FPS;"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"https://www.gsmchoice.com/en/catalogue/asus/zenfone3maxzc520tl/",rel:"nofollow noopener noreferrer",target:"_blank",children:"Asus ZenFone 3 Max 5.2"}),": 40-60 FPS."]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"Android phones have some troubles with garbage collection and there’s a ~10 FPS performance drop when going back and forth from the menu to the game screen."}),"\n",(0,a.jsxs)(s.h3,{id:"react-native-performance",children:["React Native performance",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "React Native performance"',href:"#react-native-performance",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsx)(s.p,{children:"React Native is performant overall and its capabilities are more than enough for standard user interfaces. However, when combined with game rendering and intensive processing in the game loop, you might want to limit React renders."}),"\n",(0,a.jsx)(s.p,{children:"I wanted to show the user the distance he flew during the gameplay. The natural place I wanted to put the score was the navigation bar from React Navigation but it resulted in a 10 FPS performance drop. Two options were presented:"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsx)(s.li,{children:"I could render the score in a custom component, or,"}),"\n",(0,a.jsx)(s.li,{children:"I could render the score on the canvas;"}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["The second solution was not possible to implement because ",(0,a.jsx)(s.code,{children:"expo-pixi"})," has ",(0,a.jsx)(s.a,{href:"https://github.com/expo/expo-pixi/issues/20",rel:"nofollow noopener noreferrer",target:"_blank",children:"no support for rendering text on the canvas"}),". Moving the score to a custom component had no big impact on the performance, but required some code to support notch on Apple devices. Later on, I decided to display the number of pipes passed instead and I was able to use the React Navigation back."]}),"\n",(0,a.jsxs)(s.h3,{id:"android-differences",children:["Android differences",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Android differences"',href:"#android-differences",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsx)(l,{type:"warning",children:(0,a.jsx)(s.p,{children:"Always test your application on all platforms before release. React Native offers cross-platform compatibility but some native differences have to be overcome manually."})}),"\n",(0,a.jsxs)(s.p,{children:["Some of the deviations were already described in ",(0,a.jsx)(s.a,{href:"#expo-and-libraries",children:"Expo and libraries"})," but there are more! The main differences between Android and other platforms are:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Difference in default UI/UX:"})," by default the stack navigator is configured to have the familiar iOS and Android look & feel: new screens slide in from the right on iOS and use OS default animation on Android. There are also visual differences that need to be patched to provide similar game UI/UX across platforms;"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"No full fonts support:"})," ",(0,a.jsx)(s.code,{children:"font-weight"})," and ",(0,a.jsx)(s.code,{children:"font-style"})," ",(0,a.jsx)(s.a,{href:"https://stackoverflow.com/questions/38815234/how-to-add-fonts-for-different-font-weights-for-react-native-android-project/38820631#38820631",rel:"nofollow noopener noreferrer",target:"_blank",children:"are not supported"}),". You have to load all the font variants as separate fonts with a different ",(0,a.jsx)(s.code,{children:"font-family"})," name;"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"No full shadows support:"})," Android does not have native support for CSS-like shadows. You have to use the ",(0,a.jsx)(s.a,{href:"https://reactnative.dev/docs/view-style-props#elevation-android",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"elevation"})})," property or 3rd party libraries like ",(0,a.jsx)(s.a,{href:"https://www.npmjs.com/package/react-native-shadow-2",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"react-native-shadow"})}),";"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Poor styling support"}),": for example, when making a text outline using ",(0,a.jsx)(s.code,{children:"text-shadow"}),", we have to keep a small blur radius because Android won’t render it at all when it’s set to 0 (",(0,a.jsx)(s.code,{children:"text-shadow: 0 2px 0.00001px black"}),");"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Inconsistent API:"})," on Android devices, the accelerometer data is reversed and we have to normalize it before usage:","\n",(0,a.jsx)(s.pre,{className:"language-ts",children:(0,a.jsxs)(s.code,{className:"language-ts code-highlight",children:[(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," Accelerometer ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"from"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"expo-sensors"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," Platform ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"from"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"react-native"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"})," PubSub ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"from"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"../helpers/PubSub"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"class"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"ControlManager"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"extends"})," ",(0,a.jsx)(s.span,{className:"token class-name",children:"PubSub"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"static"})," ",(0,a.jsx)(s.span,{className:"token constant",children:"MOVE"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token string",children:'"MOVE"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"register"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    Accelerometer",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"addListener"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"accelerometerData",(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token keyword",children:"const"})," data ",(0,a.jsx)(s.span,{className:"token operator",children:"="}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        ",(0,a.jsx)(s.span,{className:"token comment",children:"// For some reason on Android the signs are flipped:"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["        Platform",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token constant",children:"OS"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"==="})," ",(0,a.jsx)(s.span,{className:"token string",children:'"android"'}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["          ",(0,a.jsx)(s.span,{className:"token operator",children:"?"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"-"}),"accelerometerData",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"x\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["          ",(0,a.jsx)(s.span,{className:"token operator",children:":"})," accelerometerData",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"x",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["      ",(0,a.jsx)(s.span,{className:"token keyword",children:"this"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"publish"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ControlManager",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token constant",children:"MOVE"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," data",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsx)(s.span,{className:"code-line",children:"\n"}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token keyword",children:"public"})," ",(0,a.jsx)(s.span,{className:"token function",children:"destroy"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["    Accelerometer",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token function",children:"removeAllListeners"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:["  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]}),(0,a.jsxs)(s.span,{className:"code-line",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n"]})]})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.h2,{id:"conclusion",children:["Conclusion",(0,a.jsx)(s.a,{className:"heading-link","aria-label":'Permalink to "Conclusion"',href:"#conclusion",children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)(s.path,{d:"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"})})})]}),"\n",(0,a.jsxs)(s.p,{children:["Making a simple game was a great way to learn the Expo internals and limitations, but ",(0,a.jsx)(s.code,{children:"expo-pixi"})," it’s not the best tool for the job:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["there is a lack of support when it comes to ",(0,a.jsx)(s.code,{children:"expo-pixi"}),";"]}),"\n",(0,a.jsx)(s.li,{children:"there are plenty of bugs, especially on Android devices;"}),"\n",(0,a.jsx)(s.li,{children:"the performance is not great overall;"}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Because of that, I started working on my game library for React Native that uses ",(0,a.jsx)(s.a,{href:"https://github.com/Shopify/react-native-skia",rel:"nofollow noopener noreferrer",target:"_blank",children:(0,a.jsx)(s.code,{children:"react-native-skia"})}),", a high-performance React Native Graphics library under the hood."]})]})}function t(n,s){throw new Error("Expected "+(s?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}s.Z=function(n){void 0===n&&(n={});const{wrapper:s}=Object.assign({},(0,c.a)(),n.components);return s?(0,a.jsx)(s,Object.assign({},n,{children:(0,a.jsx)(l,n)})):l(n)}}}]);
//# sourceMappingURL=8c8d6f7f-e10c8f37ee50ed3952be.js.map